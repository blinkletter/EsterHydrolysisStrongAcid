
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Parameterized Models &#8212; Ester Hydrolysis under Strong Acid Catalysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ParameterizedModels';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/PhysOrg.png" class="logo__image only-light" alt="Ester Hydrolysis under Strong Acid Catalysis - Home"/>
    <img src="_static/PhysOrg.png" class="logo__image only-dark pst-js-only" alt="Ester Hydrolysis under Strong Acid Catalysis - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="notebooks/ParameterizedModels.html">Parameterized Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/blinkletter/EsterHydrolysisStrongAcid" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/ParameterizedModels.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Parameterized Models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-molal-to-mass">Converting Molal to %mass</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#at-25degc">At 25degC</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#refs">Refs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameterized-model-for-density">Parameterized Model for Density</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-the-polynomial-model-and-fit">make the Polynomial Model and Fit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spline-interpolation-for-density-of-h2so4-using-perry-data">Spline interpolation for density of H2SO4 using Perry Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-h-2o">Plotting <span class="math notranslate nohighlight">\(a_{H_2O}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-data-sets">Other Data Sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-data-sets">Merge Data Sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attempt-polynomial-fit">Attempt Polynomial Fit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-model">Build Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#piecewise-for-ah2o-whole-range">Piecewise for aH2O whole range</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#log-plot">Log plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reexamination-of-interpolation-by-smooth-spline">Reexamination of Interpolation by smooth spline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#models-for-h-0">Models for <span class="math notranslate nohighlight">\(H_0\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-spline-interpolation-using-johnson-and-gillespie">A Spline Interpolation USING JOHNSON AND GILLESPIE</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="parameterized-models">
<h1>Parameterized Models<a class="headerlink" href="#parameterized-models" title="Link to this heading">#</a></h1>
<p>We will create polynomial models for data tables so that we can produce values at any given input point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################</span>
<span class="c1">### Set up libraries and global variables</span>
<span class="c1">##############################################################</span>
 
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1"># no warning message and no exception is raised</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize_scalar</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.nonparametric.smoothers_lowess</span><span class="w"> </span><span class="kn">import</span> <span class="n">lowess</span>     <span class="c1"># A function for interpolating a plot using the locally weighed scatterplot smoothing method. Returns smoothed x,y points</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">CubicSpline</span>                         <span class="c1"># A function for interpolating a plot using the cubic spline method. Returns an interpolation function.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>                            <span class="c1"># A function for interpolating a plot using the connect-the-dots method. Returns an interpolation function.</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_smoothing_spline</span>               <span class="c1"># A function for interpolating a plot using a Bspline algorithm. Returns an interpolation function.</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">PathPatch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">interpolators</span>  <span class="c1"># A library of interpolation functions</span>

<span class="c1">#github_location = &quot;https://raw.githubusercontent.com/blinkletter/4410PythonNotebooks/main/Class_30/data/&quot;</span>
<span class="n">github_location</span> <span class="o">=</span> <span class="s2">&quot;./data/&quot;</span>
<span class="c1">#github_location_styles = &quot;https://raw.githubusercontent.com/blinkletter/LFER-QSAR/main/styles/&quot;</span>
<span class="n">github_location_styles</span> <span class="o">=</span> <span class="s2">&quot;./styles/&quot;</span>
<span class="n">github_location_LFER_tables</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/blinkletter/LFER-QSAR/main/data/&quot;</span>

<span class="n">molwtH2SO4</span> <span class="o">=</span> <span class="mf">98.079</span>
<span class="n">molwtH2O</span> <span class="o">=</span> <span class="mf">18.015</span>
<span class="n">densityH2SO4</span> <span class="o">=</span> <span class="mf">1.83</span>
<span class="n">densityH2O</span> <span class="o">=</span> <span class="mf">1.00</span>

<span class="n">aH2O_Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;01_Giauque_Table9_activityH2OinH2SO4.csv&quot;</span>
</pre></div>
</div>
</div>
</div>
<section id="converting-molal-to-mass">
<h2>Converting Molal to %mass<a class="headerlink" href="#converting-molal-to-mass" title="Link to this heading">#</a></h2>
<p>The code below will convert molality to %mass and moles/L</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################</span>
<span class="c1">### Import the data and perform calculations</span>
<span class="c1">##############################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_MolarConc_CRC.csv&quot;</span>

<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">### Rename columns to make them easier to use</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">:</span> <span class="s2">&quot;PercentWt&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;m(mol/Kg)&quot;</span><span class="p">:</span> <span class="s2">&quot;Molal&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;mol/L&quot;</span><span class="p">:</span> <span class="s2">&quot;Molar&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Density&quot;</span><span class="p">:</span> <span class="s2">&quot;Density&quot;</span><span class="p">})</span>

<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molal&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molal&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 

<span class="c1">### Convert Molal to Molar</span>
<span class="c1">### Molar = Molal * densityH2SO4 / (1 + (molality * (molwtH2SO4 - molwtH2O) / 1000))                </span>
<span class="n">volume</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molal&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Density&quot;</span><span class="p">]</span> <span class="o">/</span><span class="mi">1000</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molal&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">volume</span>


<span class="c1">### calculate difference between calculated and table values</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt&quot;</span><span class="p">])</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar_Diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar_Calc&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar&quot;</span><span class="p">])</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PercentWt</th>
      <th>Molal</th>
      <th>Molar</th>
      <th>Density</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.99821</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.5</td>
      <td>0.051</td>
      <td>0.051</td>
      <td>1.00160</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>0.103</td>
      <td>0.102</td>
      <td>1.00490</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PercentWt</th>
      <th>Molal</th>
      <th>Molar</th>
      <th>Density</th>
      <th>PercentWt_Calc</th>
      <th>Molar_Calc</th>
      <th>PercentWt_Diff</th>
      <th>Molar_Diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.99821</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.5</td>
      <td>0.051</td>
      <td>0.051</td>
      <td>1.00160</td>
      <td>0.497713</td>
      <td>0.050827</td>
      <td>-0.457335</td>
      <td>-0.338510</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>0.103</td>
      <td>0.102</td>
      <td>1.00490</td>
      <td>1.000110</td>
      <td>0.102470</td>
      <td>0.011045</td>
      <td>0.460332</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>0.208</td>
      <td>0.206</td>
      <td>1.01160</td>
      <td>1.999257</td>
      <td>0.206206</td>
      <td>-0.037126</td>
      <td>0.100052</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>0.315</td>
      <td>0.311</td>
      <td>1.01830</td>
      <td>2.996900</td>
      <td>0.311152</td>
      <td>-0.103346</td>
      <td>0.048717</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>57</th>
      <td>92.0</td>
      <td>117.251</td>
      <td>17.109</td>
      <td>1.82400</td>
      <td>91.999911</td>
      <td>17.109456</td>
      <td>-0.000097</td>
      <td>0.002668</td>
    </tr>
    <tr>
      <th>58</th>
      <td>94.0</td>
      <td>159.734</td>
      <td>17.550</td>
      <td>1.83120</td>
      <td>93.999958</td>
      <td>17.550416</td>
      <td>-0.000044</td>
      <td>0.002370</td>
    </tr>
    <tr>
      <th>59</th>
      <td>96.0</td>
      <td>244.698</td>
      <td>17.966</td>
      <td>1.83550</td>
      <td>95.999958</td>
      <td>17.965917</td>
      <td>-0.000044</td>
      <td>-0.000459</td>
    </tr>
    <tr>
      <th>60</th>
      <td>98.0</td>
      <td>499.592</td>
      <td>18.346</td>
      <td>1.83610</td>
      <td>97.999979</td>
      <td>18.346207</td>
      <td>-0.000021</td>
      <td>0.001127</td>
    </tr>
    <tr>
      <th>61</th>
      <td>100.0</td>
      <td>NaN</td>
      <td>18.663</td>
      <td>1.83050</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>62 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#x = df[&quot;PercentWt&quot;]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar&quot;</span><span class="p">]</span>
<span class="n">y_w_diff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt&quot;</span><span class="p">]</span>
<span class="n">y_M_diff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar_Calc&quot;</span><span class="p">]</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar&quot;</span><span class="p">]</span>

<span class="c1">#y = y_w_diff</span>
<span class="c1">#y = df[&quot;PercentWt_Diff&quot;]</span>
<span class="c1">#y = df[&quot;Molar_Diff&quot;]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_M_diff</span>

<span class="c1">###################################################</span>
<span class="c1">### MAKE PLOT</span>
<span class="c1">###################################################</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  
<span class="c1">#ax2 = ax.twinx()</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$[H_2SO_4]\;/\,M$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;Differential$\;/\,M$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
<span class="c1">#        xlim=[-0.011,0.011],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.011</span><span class="p">,</span><span class="mf">0.011</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">#ax.scatter(x, y,           # White circle behind each data point </span>
<span class="c1">#          marker = &quot;o&quot;, s = 90, </span>
<span class="c1">#          color = &quot;white&quot;, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>
<span class="c1">#ax.set(xticks = [0,25,50],</span>
<span class="c1">#       yticks = [0,25,50]</span>
<span class="c1">#        )</span>
<span class="c1"># 1:1 line</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Differential between reported molarity and value calculated from reported molality and density&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using density from CRC table at 20C&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_A1.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">### Differential Plot</span>
<span class="c1">###################################################</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Differential between reported molarity and value calculated from reported molality and density
Using density from CRC table at 20C
</pre></div>
</div>
<img alt="_images/a55af3bed697e6bfa46d2818e0cc8bbeac84fd0583a0f51b8741b0e031708a5e.png" src="_images/a55af3bed697e6bfa46d2818e0cc8bbeac84fd0583a0f51b8741b0e031708a5e.png" />
</div>
</div>
</section>
<section id="at-25degc">
<h2>At 25degC<a class="headerlink" href="#at-25degc" title="Link to this heading">#</a></h2>
<p>The data above from the CRC handobbok was a data tabkle for 20degC.  There is a second table availabe in the web edition of the hanbook that gives the data at several different tempertures including 20 and 25 degC. The data below is from “Perry’s Chemical Engineers’ Handbook” 7th ed., section 2-107. It is the same data table as in the CRC but reports data at every degree rather than every second degree. It is just the output of a parameterized model that I have no information about.</p>
<section id="refs">
<h3>Refs<a class="headerlink" href="#refs" title="Link to this heading">#</a></h3>
<p>A very recent paper that is much too complicated</p>
<p>Genetic Algorithm Workflow for Parameterization of a Water Model Using the Vashishta Force Field
Anthony Val C. Camposano, Even Marius Nordhagen, Henrik Andersen Sveinsson, and Anders Malthe-So̷renssen
The Journal of Physical Chemistry B 2025 129 (4), 1331-1342
DOI: 10.1021/acs.jpcb.4c06389</p>
<p>A polynomial model for pure water density (and also salt water)</p>
<p>Baddour, R. E. (2023). Thermohaline equation of state for pure water, seawater and brine. Journal of Hydraulic Research, 61(2), 211–219. <a class="reference external" href="https://doi.org/10.1080/00221686.2023.2180444">https://doi.org/10.1080/00221686.2023.2180444</a></p>
<p>densitywater(Temp degC)(kg/m^3) = (9.99864928×10^2) + (5.72357369×10^−2)⁢ T + (−7.96007024×10^−3⁢)T^2 + (5.32777547×10^−5)⁢T^3 + (−2.60322680×10^−7⁢)T^4 + (5.11178237×10−10)⁢T^5</p>
<p>Polynomial fits for sulfuric acid mixtures at given temp. Up to 40%H2SO4 only</p>
<p>Review and Analysis of Thermophysical Properties of a Sulfuric Acid–Water Electrolyte
Laura Oca, Jose Miguel Campillo-Robles, and M. Mounir Bou-Ali
Journal of Chemical &amp; Engineering Data 2018 63 (9), 3572-3583
DOI: 10.1021/acs.jced.8b00466
GET ref 40, 41, 47,48,49 etc…</p>
<p>Data Set from</p>
<p>Tables of physical and chemical constants and some mathematical functions / originally compiled by G.W.C. Kaye and T.H. Laby ; now prepared under the direction of an editorial committee.
London ; New York : Longman, 1986. 15th ed.
Reference section of library	QC61.K3 1986 REF</p>
<p>A four parameter fit
Surface Tensions and Densities of Sulfuric Acid + Dimethylamine + Water Solutions
Antti-P. Hyvärinen, Heikki Lihavainen, Kaisa Hautio, Tomi Raatikainen, Yrjö Viisanen, and Ari Laaksonen
Journal of Chemical &amp; Engineering Data 2004 49 (4), 917-922
DOI: 10.1021/je034225b</p>
<p>Crazy Fits
Densities and Apparent Molar Volumes of Atmospherically Important Electrolyte Solutions. 1. The Solutes H2SO4, HNO3, HCl, Na2SO4, NaNO3, NaCl, (NH4)2SO4, NH4NO3, and NH4Cl from 0 to 50 °C, Including Extrapolations to Very Low Temperature and to the Pure Liquid State, and NaHSO4, NaOH, and NH3 at 25 °C
S. L. Clegg and A. S. Wexler
The Journal of Physical Chemistry A 2011 115 (15), 3393-3460
DOI: 10.1021/jp108992a
see refs 2, 184, 117, 109</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Perry.csv&quot;</span>

<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">### Rename columns to make them easier to use</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">:</span> <span class="s2">&quot;PercentWt&quot;</span><span class="p">,</span>
                        <span class="p">})</span>

<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molal&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molal&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 

<span class="c1">### Convert Molal to Molar</span>
<span class="c1">### Molar = Molal * densityH2SO4 / (1 + (molality * (molwtH2SO4 - molwtH2O) / 1000))      </span>
<span class="c1">#density = df2[&quot;20C&quot;]          </span>
<span class="c1">#density = df[&quot;Density&quot;]          </span>
<span class="n">density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt&quot;</span><span class="p">],</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;PercentWt&quot;</span><span class="p">],</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;20C&quot;</span><span class="p">])</span>

<span class="n">volume</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molal&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="n">density</span> <span class="o">/</span><span class="mi">1000</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molal&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">volume</span>

<span class="c1">### calculate difference between calculated and table values</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt&quot;</span><span class="p">])</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar_Diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar_Calc&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar&quot;</span><span class="p">])</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PercentWt</th>
      <th>0C</th>
      <th>10C</th>
      <th>15C</th>
      <th>20C</th>
      <th>25C</th>
      <th>30C</th>
      <th>40C</th>
      <th>50C</th>
      <th>60C</th>
      <th>80C</th>
      <th>100C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>NaN</td>
      <td>0.9997</td>
      <td>0.9991</td>
      <td>0.99821</td>
      <td>0.99705</td>
      <td>0.99565</td>
      <td>0.99222</td>
      <td>0.98804</td>
      <td>0.9832</td>
      <td>0.97179</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1.0074</td>
      <td>1.0068</td>
      <td>1.0060</td>
      <td>1.00510</td>
      <td>1.00380</td>
      <td>1.00220</td>
      <td>0.99860</td>
      <td>0.99440</td>
      <td>0.9895</td>
      <td>0.97790</td>
      <td>0.9645</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1.0147</td>
      <td>1.0138</td>
      <td>1.0129</td>
      <td>1.01180</td>
      <td>1.01040</td>
      <td>1.00870</td>
      <td>1.00500</td>
      <td>1.00060</td>
      <td>0.9956</td>
      <td>0.98390</td>
      <td>0.9705</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PercentWt</th>
      <th>Molal</th>
      <th>Molar</th>
      <th>Density</th>
      <th>PercentWt_Calc</th>
      <th>Molar_Calc</th>
      <th>PercentWt_Diff</th>
      <th>Molar_Diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.99821</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.5</td>
      <td>0.051</td>
      <td>0.051</td>
      <td>1.00160</td>
      <td>0.497713</td>
      <td>0.050827</td>
      <td>-0.457335</td>
      <td>-0.338510</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>0.103</td>
      <td>0.102</td>
      <td>1.00490</td>
      <td>1.000110</td>
      <td>0.102470</td>
      <td>0.011045</td>
      <td>0.460332</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>0.208</td>
      <td>0.206</td>
      <td>1.01160</td>
      <td>1.999257</td>
      <td>0.206206</td>
      <td>-0.037126</td>
      <td>0.100052</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>0.315</td>
      <td>0.311</td>
      <td>1.01830</td>
      <td>2.996900</td>
      <td>0.311152</td>
      <td>-0.103346</td>
      <td>0.048717</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PercentWt</th>
      <th>Molal</th>
      <th>Molar</th>
      <th>Density</th>
      <th>PercentWt_Calc</th>
      <th>Molar_Calc</th>
      <th>PercentWt_Diff</th>
      <th>Molar_Diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.99821</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.5</td>
      <td>0.051</td>
      <td>0.051</td>
      <td>1.00160</td>
      <td>0.497713</td>
      <td>0.050830</td>
      <td>-0.457335</td>
      <td>-0.333037</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>0.103</td>
      <td>0.102</td>
      <td>1.00490</td>
      <td>1.000110</td>
      <td>0.102490</td>
      <td>0.011045</td>
      <td>0.480326</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>0.208</td>
      <td>0.206</td>
      <td>1.01160</td>
      <td>1.999257</td>
      <td>0.206247</td>
      <td>-0.037126</td>
      <td>0.119842</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>0.315</td>
      <td>0.311</td>
      <td>1.01830</td>
      <td>2.996900</td>
      <td>0.311182</td>
      <td>-0.103346</td>
      <td>0.058542</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>57</th>
      <td>92.0</td>
      <td>117.251</td>
      <td>17.109</td>
      <td>1.82400</td>
      <td>91.999911</td>
      <td>17.109456</td>
      <td>-0.000097</td>
      <td>0.002668</td>
    </tr>
    <tr>
      <th>58</th>
      <td>94.0</td>
      <td>159.734</td>
      <td>17.550</td>
      <td>1.83120</td>
      <td>93.999958</td>
      <td>17.550416</td>
      <td>-0.000044</td>
      <td>0.002370</td>
    </tr>
    <tr>
      <th>59</th>
      <td>96.0</td>
      <td>244.698</td>
      <td>17.966</td>
      <td>1.83550</td>
      <td>95.999958</td>
      <td>17.965917</td>
      <td>-0.000044</td>
      <td>-0.000459</td>
    </tr>
    <tr>
      <th>60</th>
      <td>98.0</td>
      <td>499.592</td>
      <td>18.346</td>
      <td>1.83610</td>
      <td>97.999979</td>
      <td>18.346207</td>
      <td>-0.000021</td>
      <td>0.001127</td>
    </tr>
    <tr>
      <th>61</th>
      <td>100.0</td>
      <td>NaN</td>
      <td>18.663</td>
      <td>1.83050</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>62 rows × 8 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="id1">
<h2><a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt&quot;</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar&quot;</span><span class="p">]</span>

<span class="n">y_w_diff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt&quot;</span><span class="p">]</span>
<span class="n">y_M_diff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar_Calc&quot;</span><span class="p">]</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar&quot;</span><span class="p">]</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">y_w_diff</span>
<span class="c1">#y = df[&quot;PercentWt_Diff&quot;]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar_Diff&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y_M_diff</span>
<span class="c1">####################################################</span>
<span class="c1">### MAKE PLOT</span>
<span class="c1">###################################################</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  
<span class="c1">#ax2 = ax.twinx()</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$[H_2SO_4]\;/\,M$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;Differential$\;/\,M$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
<span class="c1">#        xlim=[-2,50],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.011</span><span class="p">,</span><span class="mf">0.011</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">#ax.scatter(x, y,           # White circle behind each data point </span>
<span class="c1">#          marker = &quot;o&quot;, s = 90, </span>
<span class="c1">#          color = &quot;white&quot;, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>
<span class="c1">#ax.set(xticks = [0,25,50],</span>
<span class="c1">#       yticks = [0,25,50]</span>
<span class="c1">#        )</span>
<span class="c1"># 1:1 line</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Differential between reported molarity and value calculated from reported molality and density&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using density interpolated from Perry table at 20C&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_A2.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">### Differential Plot</span>
<span class="c1">###################################################</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Differential between reported molarity and value calculated from reported molality and density
Using density interpolated from Perry table at 20C
</pre></div>
</div>
<img alt="_images/2b9f5ff4d70c5177721f3be69fb4828c13035295a0242b1aa60ab6ac89c45e05.png" src="_images/2b9f5ff4d70c5177721f3be69fb4828c13035295a0242b1aa60ab6ac89c45e05.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt&quot;</span><span class="p">]</span>
<span class="n">y_w_diff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt&quot;</span><span class="p">]</span>
<span class="n">y_M_diff</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar_Calc&quot;</span><span class="p">]</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Molar&quot;</span><span class="p">]</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">y_w_diff</span>
<span class="c1">#y = df[&quot;PercentWt_Diff&quot;]</span>
<span class="c1">#y = df[&quot;Molar_Diff&quot;]</span>
<span class="c1">####################################################</span>
<span class="c1">### MAKE PLOT</span>
<span class="c1">###################################################</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  
<span class="c1">#ax2 = ax.twinx()</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;Differential&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
<span class="c1">#        xlim=[-2,50],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.11</span><span class="p">,</span><span class="mf">0.11</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">#ax.scatter(x, y,           # White circle behind each data point </span>
<span class="c1">#          marker = &quot;o&quot;, s = 90, </span>
<span class="c1">#          color = &quot;white&quot;, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>
<span class="c1">#ax.set(xticks = [0,25,50],</span>
<span class="c1">#       yticks = [0,25,50]</span>
<span class="c1">#        )</span>
<span class="c1"># 1:1 line</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Differential between reported %H2SO4 and value calculated from reported molality&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_A3.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">### Differential Plot</span>
<span class="c1">###################################################</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Differential between reported %H2SO4 and value calculated from reported molality
</pre></div>
</div>
<img alt="_images/7855f3aa3d1a354b5a1dabda92a341e8de9d7fb0bf335842c42e2e8b508b7803.png" src="_images/7855f3aa3d1a354b5a1dabda92a341e8de9d7fb0bf335842c42e2e8b508b7803.png" />
</div>
</div>
</section>
<section id="parameterized-model-for-density">
<h2>Parameterized Model for Density<a class="headerlink" href="#parameterized-model-for-density" title="Link to this heading">#</a></h2>
<p>Below I will make a parameterized model for density vs %mass.</p>
<p>First I will plot my data sets.”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
<span class="c1">#ax2 = ax.twinx()</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\rho\ / \,(g/cm^{-3})$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">2.05</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Perry.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;25C&quot;</span><span class="p">]</span>

<span class="c1">#ax.plot(x, y,  </span>
<span class="c1">#          color = &quot;black&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">### Get and plot Rhodes data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Rhodes.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;25C&quot;</span><span class="p">]</span>

<span class="c1">#ax.plot(x, y,  </span>
<span class="c1">#          color = &quot;black&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">###################################################</span>
<span class="c1">### Get and plot Oca data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Oca.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;298.15K&quot;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#ax.plot(x, y,  </span>
<span class="c1">#          color = &quot;red&quot;, linewidth=2, </span>
<span class="c1">#          zorder = 1)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_B1.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/081578bad7e2b936c8e0853764ec431e9a026c2b6860aa266dcb0a14e2d89ed4.png" src="_images/081578bad7e2b936c8e0853764ec431e9a026c2b6860aa266dcb0a14e2d89ed4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
<span class="c1">#ax2 = ax.twinx()</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\rho\ / \,(g/cm^{-3})$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">2.05</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Perry.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;20C&quot;</span><span class="p">]</span>

<span class="c1">#ax.plot(x, y,  </span>
<span class="c1">#          color = &quot;black&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">### Get and plot Rhodes data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Kaye.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;20C&quot;</span><span class="p">]</span>

<span class="c1">#ax.plot(x, y,  </span>
<span class="c1">#          color = &quot;black&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">###################################################</span>
<span class="c1">### Get and plot Oca data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Oca.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;293.15K&quot;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#ax.plot(x, y,  </span>
<span class="c1">#          color = &quot;red&quot;, linewidth=2, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_B2.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7ed672aef9de00439d393ffa5b3230c32a1bea709ec97d2bf013a7d52f040e85.png" src="_images/7ed672aef9de00439d393ffa5b3230c32a1bea709ec97d2bf013a7d52f040e85.png" />
</div>
</div>
</section>
<section id="make-the-polynomial-model-and-fit">
<h2>make the Polynomial Model and Fit<a class="headerlink" href="#make-the-polynomial-model-and-fit" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deg</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">99</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
<span class="c1">#ax2 = ax.twinx()</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\rho\ / \,(\text{g/cm}^</span><span class="si">{3}</span><span class="s2">)$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.95</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="c1">###################################################</span>
<span class="c1">### Get a Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Perry.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 


<span class="c1">###################################################</span>
<span class="c1">### remove 25 data points from dataframe at random. Keep both sets.</span>
<span class="c1">###################################################</span>

<span class="n">validate_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">)</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">validate_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>   

<span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">validate_df</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">#x = train_df[&quot;%H2SO4&quot;]</span>
<span class="c1">#y = train_df[&quot;25C&quot;]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;25C&quot;</span><span class="p">]</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="c1">###################################################</span>
<span class="c1">### plot results of polynomial for x</span>
<span class="c1">################################################### </span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_B3.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>



<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  
<span class="c1">#ax2 = ax.twinx()</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\rho\ / \,(\text{g/cm}^</span><span class="si">{3}</span><span class="s2">)$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">94</span><span class="p">,</span><span class="mi">101</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.795</span><span class="p">,</span><span class="mf">1.85</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_B3A.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>


<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  
<span class="c1">#ax2 = ax.twinx()</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta \rho\ / \,(\text{g/cm}^</span><span class="si">{3}</span><span class="s2">)$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.022</span><span class="p">,</span><span class="mf">0.022</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidit</span>
<span class="c1">###################################################</span>
<span class="c1">### calculate difference</span>
<span class="c1">###################################################</span>
<span class="n">x_diff</span> <span class="o">=</span> <span class="n">validate_df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="n">validate_df</span><span class="p">[</span><span class="s2">&quot;25C&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">validate_df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">])</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x_diff</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">#ax.plot(x_diff, y_diff,  </span>
<span class="c1">#          color = &quot;black&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_B4.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2.16110754e-08  3.61273738e-06 -1.54569891e-04  9.46862566e-03
  9.86506794e-01]
</pre></div>
</div>
<img alt="_images/84c5ae6b157821de580f17a001d55c59b3b24b00249d3ddd90a4a48a71572b66.png" src="_images/84c5ae6b157821de580f17a001d55c59b3b24b00249d3ddd90a4a48a71572b66.png" />
<img alt="_images/7745c8dd144b7bd60d9761e8b5e5a7552ceb8f48873a9e9528b42427b0c0b4b7.png" src="_images/7745c8dd144b7bd60d9761e8b5e5a7552ceb8f48873a9e9528b42427b0c0b4b7.png" />
<img alt="_images/e35bef340f30785b76fbfb0a0ecfbaa8bdbb2d63c201e927f08148212d3b7149.png" src="_images/e35bef340f30785b76fbfb0a0ecfbaa8bdbb2d63c201e927f08148212d3b7149.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deg</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">99</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot with insets</span>
<span class="c1">###################################################</span>


<span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">],</span>
                               <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]],</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                              <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>


<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">### Get a Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Perry.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Hyvarinen.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x_hyv</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;X H2SO4&quot;</span><span class="p">]</span>
<span class="n">x_hyv_w</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_hyv</span><span class="o">*</span><span class="n">molwtH2SO4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x_hyv</span><span class="o">*</span><span class="n">molwtH2SO4</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x_hyv</span><span class="p">)</span><span class="o">*</span><span class="n">molwtH2O</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
<span class="n">y_hyv</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;25C&quot;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span>

<span class="c1">###################################################</span>
<span class="c1">### remove 25 data points from dataframe at random. Keep both sets.</span>
<span class="c1">###################################################</span>

<span class="n">validate_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">)</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">validate_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>   

<span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">validate_df</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">#x = train_df[&quot;%H2SO4&quot;]</span>
<span class="c1">#y = train_df[&quot;25C&quot;]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;25C&quot;</span><span class="p">]</span>

<span class="c1"># set weights for polynomial fit</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                         <span class="c1"># create list of ones same length as x</span>
<span class="c1">#weights[-10:] = [10]*10                     # relace last 10 entries in list with 10</span>
<span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>       <span class="c1"># replace last 10 entries in list</span>
<span class="c1">#weights[0:10] = [10]*10                     # relace first 10 entries in list with 10</span>
<span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>       <span class="c1"># replace first 10 entries in list</span>
<span class="c1">#print(weights)</span>
<span class="c1">#weights = None                               # erase weights to do unweighted fit</span>

<span class="c1"># fit polynomial with weights</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>

<span class="n">p1</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4410</span><span class="p">,</span> <span class="mi">9090</span><span class="p">,</span> <span class="o">-</span><span class="mi">7230</span><span class="p">,</span>  <span class="mi">3420</span><span class="p">,</span> <span class="mf">997.05</span><span class="p">]</span>

<span class="n">x1_mf</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="o">/</span><span class="n">molwtH2SO4</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="n">molwtH2SO4</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">/</span><span class="n">molwtH2O</span><span class="p">)</span> <span class="c1"># convert line w to mole fraction</span>
<span class="n">x_mf</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">molwtH2SO4</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">x</span><span class="o">/</span><span class="n">molwtH2SO4</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">molwtH2O</span><span class="p">)</span>     <span class="c1"># convert Perry w to mole fraction</span>

<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">x1_mf</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span>                <span class="c1"># y values for polynomial line with fixed coefficients </span>
<span class="n">y_mf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">x_mf</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span>               <span class="c1"># y values for Perry w with fixed coefficients </span>
<span class="n">y_hyv_mf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">x_hyv</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span>          <span class="c1"># y values for Hyvarinen w with fixed coefficients</span>

<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\rho\ / \,(\text{g/cm}^</span><span class="si">{3}</span><span class="s2">)$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Polynomial Fit Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
<span class="c1">#        xlim=[-5,105],</span>
<span class="c1">#        ylim=[0.89,2]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_hyv_w</span><span class="p">,</span> <span class="n">y_hyv</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>



<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\rho\ / \,(\text{g/cm}^</span><span class="si">{3}</span><span class="s2">)$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Plot results of polynomial fit - inset</span>
<span class="c1">###################################################</span>


<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">89.5</span><span class="p">,</span><span class="mi">101</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.795</span><span class="p">,</span><span class="mf">1.85</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#axd[&quot;left&quot;].plot(x1, y2,  </span>
<span class="c1">#          color = &quot;green&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>




<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\, \rho\ / \,(\text{g/cm}^</span><span class="si">{3}</span><span class="s2">)$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.02</span><span class="p">],</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.015</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.015</span><span class="p">]</span>       
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidit</span>
<span class="c1">###################################################</span>
<span class="c1">### calculate difference</span>
<span class="c1">###################################################</span>
<span class="c1"># x_diff = validate_df[&quot;%H2SO4&quot;]</span>
<span class="c1"># y_diff = validate_df[&quot;25C&quot;] - np.polyval(p, validate_df[&quot;%H2SO4&quot;])</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x_diff</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="n">y_mf</span> <span class="o">-</span> <span class="n">y</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x_hyv_w</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="n">y_hyv</span> <span class="o">-</span> <span class="n">y_hyv_mf</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1">#axd[&quot;right&quot;].plot(x_diff, y_diff,  </span>
<span class="c1">#          color = &quot;black&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x_hyv_w</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_B5.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2.27374401e-08  3.58002513e-06 -1.30169768e-04  8.29495325e-03
  9.94729453e-01]
0      0.542021
1      1.611799
2      3.181734
3      4.205899
4     12.688942
5     22.995908
6     34.999381
7     43.749331
8     54.443770
9     64.473061
10    74.564702
11    83.403879
Name: X H2SO4, dtype: float64
</pre></div>
</div>
<img alt="_images/f60ccaafd06706c00190aceb8ecb4af892a6050028bd53be840a44869271f1fd.png" src="_images/f60ccaafd06706c00190aceb8ecb4af892a6050028bd53be840a44869271f1fd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deg</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">99</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot with insets</span>
<span class="c1">###################################################</span>


<span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">],</span>
                               <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]],</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                              <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>


<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">### Get a Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Perry.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Oca.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x_oca</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y_oca</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;298.15K&quot;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span>

<span class="c1">###################################################</span>
<span class="c1">### remove 25 data points from dataframe at random. Keep both sets.</span>
<span class="c1">###################################################</span>

<span class="n">validate_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">)</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">validate_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>   

<span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">validate_df</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">#x = train_df[&quot;%H2SO4&quot;]</span>
<span class="c1">#y = train_df[&quot;25C&quot;]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;25C&quot;</span><span class="p">]</span>

<span class="c1"># set weights for polynomial fit</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                         <span class="c1"># create list of ones same length as x</span>
<span class="c1">#weights[-10:] = [10]*10                     # relace last 10 entries in list with 10</span>
<span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>       <span class="c1"># replace last 10 entries in list</span>
<span class="c1">#weights[0:10] = [10]*10                     # relace first 10 entries in list with 10</span>
<span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>       <span class="c1"># replace first 10 entries in list</span>
<span class="c1">#print(weights)</span>
<span class="c1">#weights = None                               # erase weights to do unweighted fit</span>

<span class="c1"># fit polynomial with weights</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>


<span class="n">p1_matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1122</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5076</span><span class="p">,</span> <span class="mf">2.484e-4</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">976.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.015</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">237.8</span><span class="p">]]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">poly_oca</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">T</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p1_matrix</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p1_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
                        <span class="n">total</span> <span class="o">+=</span> <span class="n">p1_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="n">i</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="n">j</span>
        <span class="k">return</span> <span class="n">total</span>

<span class="n">y2</span> <span class="o">=</span> <span class="n">poly_oca</span><span class="p">(</span><span class="n">p1_matrix</span><span class="p">,</span> <span class="n">x1</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="mf">298.15</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span>                <span class="c1"># y values for polynomial line with fixed coefficients </span>
<span class="n">y_oca2</span> <span class="o">=</span> <span class="n">poly_oca</span><span class="p">(</span><span class="n">p1_matrix</span><span class="p">,</span> <span class="n">x_oca</span><span class="p">,</span> <span class="mf">298.15</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span>          <span class="c1"># y values for oca w with fixed coefficients</span>

<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\rho\ / \,(\text{g/cm}^</span><span class="si">{3}</span><span class="s2">)$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Polynomial Fit Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
<span class="c1">#        xlim=[-5,105],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.89</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_oca</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">y_oca</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>



<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\rho\ / \,(\text{g/cm}^</span><span class="si">{3}</span><span class="s2">)$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Plot results of polynomial fit - inset</span>
<span class="c1">###################################################</span>


<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">89.5</span><span class="p">,</span><span class="mi">101</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.795</span><span class="p">,</span><span class="mf">1.85</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>




<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\, \rho\ / \,(\text{g/cm}^</span><span class="si">{3}</span><span class="s2">)$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.02</span><span class="p">],</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.015</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.015</span><span class="p">]</span>       
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidit</span>
<span class="c1">###################################################</span>
<span class="c1">### calculate difference</span>
<span class="c1">###################################################</span>
<span class="c1"># x_diff = validate_df[&quot;%H2SO4&quot;]</span>
<span class="c1"># y_diff = validate_df[&quot;25C&quot;] - np.polyval(p, validate_df[&quot;%H2SO4&quot;])</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x_diff</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x1</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x_oca</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="n">y_oca</span> <span class="o">-</span> <span class="n">y_oca2</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1">#axd[&quot;right&quot;].plot(x_diff, y_diff,  </span>
<span class="c1">#          color = &quot;black&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>

<span class="c1">#print(x_oca)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_B5A.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.66034812e-12  1.74391677e-10  3.16815068e-09 -6.35831565e-07
  4.29036112e-05  6.34761619e-03  9.97297592e-01]
</pre></div>
</div>
<img alt="_images/c48023e1cc63d2f8a86087fe5265375afe212a383a046f0fed716dd55344efab.png" src="_images/c48023e1cc63d2f8a86087fe5265375afe212a383a046f0fed716dd55344efab.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1_matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1122</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5076</span><span class="p">,</span> <span class="mf">2.484e-4</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">976.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.015</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">237.8</span><span class="p">]]</span>

<span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">273.15</span>
<span class="n">w</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">x_oca</span><span class="o">/</span><span class="mi">100</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p1_matrix</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p1_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p1_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s2">w^</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">T^</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; + &quot;</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">p1_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">w</span><span class="o">**</span><span class="n">i</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="n">j</span>
<span class="c1">#print(total)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1122w^0T^0 + -0.5076w^0T^1 + 0.0002484w^0T^2 + 976.4w^1T^0 + -1.015w^1T^1 + 237.8w^2T^0 + 
</pre></div>
</div>
</div>
</div>
</section>
<section id="spline-interpolation-for-density-of-h2so4-using-perry-data">
<h2>Spline interpolation for density of H2SO4 using Perry Data<a class="headerlink" href="#spline-interpolation-for-density-of-h2so4-using-perry-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################</span>
<span class="c1">### Get a Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Perry.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;03_H2SO4_PercentWt_to_Density_Temp_Oca.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x_oca</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y_oca</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;298.15K&quot;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span>

<span class="c1">###################################################</span>
<span class="c1">### remove 25 data points from dataframe at random. Keep both sets.</span>
<span class="c1">###################################################</span>

<span class="n">validate_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">)</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">validate_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>   

<span class="k">if</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">validate_df</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">#x = train_df[&quot;%H2SO4&quot;]</span>
<span class="c1">#y = train_df[&quot;25C&quot;]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;25C&quot;</span><span class="p">]</span>


<span class="n">interpolation</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">make_interp_spline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1">#interpolation = scipy.interpolate.Akima1DInterpolator(x, y, method = &quot;akima&quot;)        </span>
 
<span class="c1">#interpolation = scipy.interpolate.make_smoothing_spline(x, y,   # The x and y data</span>
<span class="c1">#                                w=None,       # A list of weights for each point (default = None)</span>
<span class="c1">#                                lam=0.005        # A factor for the degree of smoothing. Change this to change the smoothness.</span>
<span class="c1">#                                )        </span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1interp</span> <span class="o">=</span> <span class="n">interpolation</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>  
<span class="c1">#ax2 = ax.twinx()</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\rho\ / \,(\text{g/cm}^</span><span class="si">{3}</span><span class="s2">)$&quot;</span> 

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span> <span class="o">=</span> <span class="n">y_label</span><span class="p">,</span> 
          <span class="n">xlabel</span> <span class="o">=</span> <span class="n">x_label</span><span class="p">,</span>
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">102</span><span class="p">],</span>
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.95</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1interp</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1interp</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="c1">#ax[0].vlines(100, -8.2, -13, linewidth=0.7, color=&quot;black&quot;, zorder = 0)</span>

<span class="c1">##################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">88.5</span><span class="p">,</span><span class="mi">101</span><span class="p">],</span>
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1.798</span><span class="p">,</span><span class="mf">1.835</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1interp</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1interp</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.2</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">##################################</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_B6.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8705f0d7a198acd40351a80574b4ab616a7b74a5b35449cb7a495fd7fa1cf120.png" src="_images/8705f0d7a198acd40351a80574b4ab616a7b74a5b35449cb7a495fd7fa1cf120.png" />
</div>
</div>
</section>
<section id="plotting-a-h-2o">
<h2>Plotting <span class="math notranslate nohighlight">\(a_{H_2O}\)</span><a class="headerlink" href="#plotting-a-h-2o" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">} \,(</span><span class="si">{p_x}</span><span class="s2">/{p_</span><span class="si">{_0}</span><span class="s2">})$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Setup Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>

<span class="n">test</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>   <span class="c1"># A, B, or C</span>

<span class="k">if</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;A&quot;</span><span class="p">:</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">31</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.795</span><span class="p">,</span><span class="mf">1.01</span><span class="p">],</span>
        <span class="n">xticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.90</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
        <span class="p">)</span>
<span class="k">elif</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span>   
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">58</span><span class="p">,</span><span class="mi">80</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.10</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.20</span><span class="p">]</span>
        <span class="p">)</span>
<span class="k">elif</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>   
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">103</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">1.02</span><span class="p">],</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
        <span class="p">)</span>
<span class="k">elif</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;D&quot;</span><span class="p">:</span>   
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">89.95</span><span class="p">,</span><span class="mf">100.05</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1E-6</span><span class="p">,</span><span class="mf">2E-4</span><span class="p">],</span>
    <span class="c1">#    yticks = []</span>
        <span class="p">)</span>

<span class="c1"># Data points for kobs vs Acidity</span>

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Giauque data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;01_Giauque_Table9_activityH2OinH2SO4.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;conc H2SO4 / m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;conc H2SO4 / m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 
<span class="n">dfg</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">dfg</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dfg</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">### Get and plot Rhodes data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;01_Rard_TableIV_activityH2OinH2SO4.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;conc H2SO4 / m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;conc H2SO4 / m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 
<span class="n">dfr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">dfr</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dfr</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
         <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> 
         <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
         <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">### Get and plot Oca data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;01_Staples_Table42_activityH2OinH2SO4.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;conc H2SO4 / m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;conc H2SO4 / m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 
<span class="n">dfs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>


<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_C1&quot;</span><span class="o">+</span><span class="n">test</span><span class="o">+</span><span class="s2">&quot;.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ffadd01c3ee8762470627da89aee92f4f10574738633bc8d9772ed89f89abaaf.png" src="_images/ffadd01c3ee8762470627da89aee92f4f10574738633bc8d9772ed89f89abaaf.png" />
</div>
</div>
</section>
<section id="other-data-sets">
<h2>Other Data Sets<a class="headerlink" href="#other-data-sets" title="Link to this heading">#</a></h2>
<p>Below we repeat the above using data from Giauque, Resnick and a Textbook (Drying). We see again that they might be all from the same model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">} \,(</span><span class="si">{p_x}</span><span class="s2">/{p_</span><span class="si">{_0}</span><span class="s2">})$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Setup Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>

<span class="n">test</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>   <span class="c1"># A, B, or C</span>

<span class="k">if</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;A&quot;</span><span class="p">:</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">31</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.795</span><span class="p">,</span><span class="mf">1.01</span><span class="p">],</span>
        <span class="n">xticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.90</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
        <span class="p">)</span>
<span class="k">elif</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span>   
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">58</span><span class="p">,</span><span class="mi">80</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.10</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.20</span><span class="p">]</span>
        <span class="p">)</span>
<span class="k">elif</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>   
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">103</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">1.02</span><span class="p">],</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>
        <span class="p">)</span>
<span class="k">elif</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;D&quot;</span><span class="p">:</span>   
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">89.95</span><span class="p">,</span><span class="mf">100.05</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1E-6</span><span class="p">,</span><span class="mf">2E-4</span><span class="p">],</span>
    <span class="c1">#    yticks = []</span>
        <span class="p">)</span>

<span class="c1"># Data points for kobs vs Acidity</span>

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Giauque data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;01_Giauque_Table9_activityH2OinH2SO4.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;conc H2SO4 / m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;conc H2SO4 / m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 
<span class="n">dfg</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">dfg</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dfg</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">### Get and plot Rhodes data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;01_Drying_Table2.19_activityH2OinH2SO4.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="c1">#df[&quot;PercentWt_Calc&quot;] = (df[&quot;conc H2SO4 / m&quot;] * molwtH2SO4) / (df[&quot;conc H2SO4 / m&quot;] * molwtH2SO4 + 1000) * 100 </span>
<span class="n">dfr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">dfr</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dfr</span><span class="p">[</span><span class="s2">&quot;25C&quot;</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
         <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> 
         <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
         <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">### Get and plot Oca data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;01_Resnick_Table4_activityH2OinH2SO4.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="c1">#df[&quot;PercentWt_Calc&quot;] = (df[&quot;conc H2SO4 / m&quot;] * molwtH2SO4) / (df[&quot;conc H2SO4 / m&quot;] * molwtH2SO4 + 1000) * 100 </span>
<span class="n">dfs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;25C&quot;</span><span class="p">]</span>


<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_X1&quot;</span><span class="o">+</span><span class="n">test</span><span class="o">+</span><span class="s2">&quot;.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3b9c376ff57d282f6f24304d2fe6da0b6c7347a629b84a1c45bc291735021ab2.png" src="_images/3b9c376ff57d282f6f24304d2fe6da0b6c7347a629b84a1c45bc291735021ab2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="mf">15.5</span>
<span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>60.32099521292646
</pre></div>
</div>
</div>
</div>
</section>
<section id="merge-data-sets">
<h2>Merge Data Sets<a class="headerlink" href="#merge-data-sets" title="Link to this heading">#</a></h2>
<p>The code below will merge the data sets for data/01_Rard_TableIV_activityH2OinH2SO4.csv and data/01_Giauque_Table9_activityH2OinH2SO4.csv</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;01_Giauque_Table9_activityH2OinH2SO4.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">dfg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 
<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;01_Rard_TableIV_activityH2OinH2SO4.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">dfr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span>

<span class="c1"># rename columns to avoid confusion</span>
<span class="n">dfg</span> <span class="o">=</span> <span class="n">dfg</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;conc H2SO4 / m&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">})</span>
<span class="n">dfr</span> <span class="o">=</span> <span class="n">dfr</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;conc H2SO4 / m&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">})</span>

 <span class="c1"># keep only columns &quot;m&quot; and &quot;aH2O&quot;</span>
<span class="n">dfg</span> <span class="o">=</span> <span class="n">dfg</span><span class="p">[[</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;aH2O&quot;</span><span class="p">]]</span>
<span class="n">dfr</span> <span class="o">=</span> <span class="n">dfr</span><span class="p">[[</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;aH2O&quot;</span><span class="p">]]</span>


<span class="c1"># concatenate dataframes and remove duplicate rows</span>
<span class="c1">#df = pd.concat([dfg, dfr]).drop_duplicates(subset=&quot;m&quot;, keep=&quot;last&quot;).sort_values(by=&quot;m&quot;).reset_index(drop=True)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfg</span><span class="p">,</span> <span class="n">dfr</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">github_location</span><span class="o">+</span><span class="s2">&quot;aH2O_data.csv&quot;</span><span class="p">)</span>   
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>m</th>
      <th>aH2O</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.1</td>
      <td>0.99633</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.2</td>
      <td>0.99284</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.3</td>
      <td>0.98928</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.4</td>
      <td>0.98564</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.5</td>
      <td>0.98192</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="attempt-polynomial-fit">
<h2>Attempt Polynomial Fit<a class="headerlink" href="#attempt-polynomial-fit" title="Link to this heading">#</a></h2>
<p>The final values of the data set are tiny. Any squigles in the polynomial fit are disastrous. There was no degree that seemed to solve the problem. I will need to use smaller ranges and a piecewise fit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deg</span> <span class="o">=</span> <span class="mi">12</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot with insets</span>
<span class="c1">###################################################</span>

<span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">],</span>
                               <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]],</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                              <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get a Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;aH2O_data.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 


<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>

<span class="c1"># set weights for polynomial fit</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                         <span class="c1"># create list of ones same length as x</span>
<span class="c1">#weights[-10:] = [10]*10                     # relace last 10 entries in list with 10</span>
<span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="mi">16</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">]</span>       <span class="c1"># replace last 10 entries in list</span>
<span class="c1">#weights[0:10] = [10]*10                     # relace first 10 entries in list with 10</span>
<span class="c1">#weights[0:10] = [10,9,8,7,6,5,4,3,2,1]       # replace first 10 entries in list</span>
<span class="c1">#print(weights)</span>
<span class="n">weights</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">y</span>                               <span class="c1"># erase weights to do unweighted fit</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;weights&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># fit polynomial with weights</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Polynomial Fit Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>



<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Plot results of polynomial fit - inset</span>
<span class="c1">###################################################</span>


<span class="c1"># Set up axes for main plot</span>
<span class="c1">#axd[&quot;left&quot;].set(ylabel=y_label, xlabel=x_label,</span>
<span class="c1">#        xlim=[69.5,101],</span>
<span class="c1">#        ylim=[-0.03,0.1]</span>
<span class="c1">#        )</span>
<span class="c1">#axd[&quot;left&quot;].set(ylabel=y_label, xlabel=x_label,</span>
<span class="c1">#        xlim=[84.5,100.2],</span>
<span class="c1">#        ylim=[-0.00005,0.0005],</span>
<span class="c1">#        xticks = [85,90,95,100]</span>
<span class="c1">#        )</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">75</span><span class="p">,</span><span class="mf">100.2</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.0003</span><span class="p">,</span><span class="mf">0.005</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>




<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\;a_{_</span><span class="si">{H_2O}</span><span class="s2">}\ /\%$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">10.9</span><span class="p">,</span><span class="mf">10.5</span><span class="p">],</span>
<span class="c1">#        yticks = [-0.015,0,0.015]       </span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidit</span>
<span class="c1">###################################################</span>
<span class="c1">### calculate difference</span>
<span class="c1">###################################################</span>
<span class="c1"># x_diff = validate_df[&quot;%H2SO4&quot;]</span>
<span class="c1"># y_diff = validate_df[&quot;25C&quot;] - np.polyval(p, validate_df[&quot;%H2SO4&quot;])</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x_diff</span><span class="p">))</span><span class="o">/</span><span class="n">y</span><span class="o">*</span><span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_diff</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>

<span class="c1">#print(x_oca)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_D1.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">iter</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x_diff</span><span class="p">),</span> <span class="n">y</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x_diff</span><span class="p">),</span> <span class="n">y_diff</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;w,         aH2O,       aH2O_fit,         diff,       </span><span class="si">%d</span><span class="s2">iff&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">8.4g</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">b</span><span class="si">:</span><span class="s2">8.4g</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s2">10.4g</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">14.4g</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">e</span><span class="si">:</span><span class="s2">12.4g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average error: </span><span class="si">{</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">x_diff</span><span class="p">))</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="si">:</span><span class="s2">8.4g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>weights
0      1.003684e+00
1      1.007212e+00
2      1.010836e+00
3      1.014569e+00
4      1.018413e+00
           ...     
96     7.246377e+04
97     1.270648e+05
98     1.923077e+05
99     6.666667e+05
100    6.410256e+08
Name: aH2O, Length: 101, dtype: float64

0     -0.695742
1     -0.163157
2      0.164810
3      0.341246
4      0.409012
         ...   
96     1.538694
97     0.056909
98    -1.120266
99     0.228409
100    0.079999
Name: aH2O, Length: 101, dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/_0/pb9y62rd59n_3vs7rbl1bndm0000gn/T/ipykernel_55614/3526387101.py:56: RankWarning: Polyfit may be poorly conditioned
  p = np.polyfit(x, y, deg, rcond=None, full=False, w=weights, cov=False)
</pre></div>
</div>
<img alt="_images/aa3c4b43927c9c33240070b7335ea97d334644f29a0d43b166e998285816c38d.png" src="_images/aa3c4b43927c9c33240070b7335ea97d334644f29a0d43b166e998285816c38d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>w,         aH2O,       aH2O_fit,         diff,       %diff
  0.9713,  0.9963,     1.003,     -0.006932,     -0.6957
   1.924,  0.9928,    0.9945,      -0.00162,     -0.1632
   2.858,  0.9893,    0.9876,       0.00163,      0.1648
   3.775,  0.9856,    0.9823,      0.003363,      0.3412
   4.675,  0.9819,    0.9779,      0.004016,       0.409
   5.558,  0.9781,    0.9742,       0.00392,      0.4008
   6.424,  0.9742,    0.9709,       0.00334,      0.3428
   7.275,  0.9702,    0.9677,      0.002467,      0.2543
   8.111,  0.9661,    0.9647,      0.001445,      0.1495
   8.932,  0.9619,    0.9615,     0.0003845,     0.03997
   8.932,  0.9622,    0.9615,     0.0007045,     0.07322
   10.53,  0.9531,    0.9547,     -0.001571,     -0.1649
   12.07,  0.9438,    0.9469,     -0.003051,     -0.3233
   13.56,   0.934,     0.938,     -0.003953,     -0.4233
   15.01,  0.9237,     0.928,     -0.004278,     -0.4632
    16.4,   0.913,     0.917,     -0.003991,     -0.4371
    16.4,  0.9129,     0.917,     -0.004131,     -0.4525
   17.75,  0.9015,    0.9051,     -0.003621,     -0.4017
   19.05,  0.8897,    0.8925,     -0.002798,     -0.3145
   20.32,  0.8773,    0.8792,     -0.001944,     -0.2216
   21.55,  0.8646,    0.8655,    -0.0008735,      -0.101
   22.73,  0.8514,    0.8513,     0.0001158,      0.0136
   22.73,  0.8514,    0.8513,     0.0001158,      0.0136
   23.89,  0.8378,    0.8368,      0.001039,      0.1241
   25.01,  0.8238,     0.822,      0.001827,      0.2217
   26.09,  0.8095,     0.807,      0.002518,      0.3111
   27.15,   0.795,    0.7918,      0.003165,      0.3981
   28.18,  0.7801,    0.7766,      0.003526,       0.452
   28.18,    0.78,    0.7766,      0.003426,      0.4392
   30.62,  0.7423,    0.7381,      0.004158,      0.5601
    32.9,  0.7035,    0.6996,      0.003863,      0.5491
    32.9,  0.7036,    0.6996,      0.003963,      0.5632
   35.04,  0.6647,    0.6614,      0.003314,      0.4985
   37.05,  0.6261,    0.6237,      0.002438,      0.3894
   37.05,  0.6257,    0.6237,      0.002038,      0.3257
   38.93,  0.5881,    0.5867,      0.001397,      0.2375
   40.71,  0.5511,    0.5507,     0.0003807,     0.06908
   40.71,  0.5503,    0.5507,    -0.0004193,    -0.07619
   42.38,  0.5154,    0.5159,    -0.0004911,    -0.09529
   43.97,  0.4811,    0.4824,     -0.001268,     -0.2636
   43.97,  0.4806,    0.4824,     -0.001768,     -0.3679
   45.46,  0.4484,    0.4503,     -0.001867,     -0.4164
   46.89,  0.4174,    0.4197,     -0.002273,     -0.5446
   46.89,  0.4175,    0.4197,     -0.002173,     -0.5205
   48.23,  0.3881,    0.3906,     -0.002541,     -0.6546
   49.52,  0.3606,    0.3632,     -0.002597,     -0.7201
   49.52,  0.3611,    0.3632,     -0.002097,     -0.5806
   50.73,  0.3348,    0.3373,     -0.002544,       -0.76
    51.9,  0.3107,    0.3131,     -0.002367,     -0.7618
    51.9,  0.3113,    0.3131,     -0.001767,     -0.5675
   53.01,  0.2882,    0.2903,      -0.00213,      -0.739
   54.06,  0.2673,    0.2691,     -0.001787,     -0.6686
   54.06,  0.2678,    0.2691,     -0.001287,     -0.4807
   55.08,  0.2478,    0.2493,     -0.001482,     -0.5981
   56.04,  0.2298,    0.2309,     -0.001051,     -0.4574
   56.04,  0.2303,    0.2309,    -0.0005512,     -0.2393
   56.97,   0.213,    0.2137,    -0.0007261,     -0.3409
   57.86,   0.198,    0.1978,      0.000164,     0.08284
   57.86,  0.1975,    0.1978,     -0.000336,     -0.1701
   58.71,  0.1831,    0.1831,    -8.891e-06,   -0.004856
   59.53,  0.1701,    0.1695,     0.0006269,      0.3685
   59.53,  0.1697,    0.1695,     0.0002269,      0.1337
   60.32,  0.1573,    0.1569,     0.0004418,      0.2809
   61.08,  0.1459,    0.1452,     0.0007044,      0.4828
   61.08,  0.1462,    0.1452,      0.001004,       0.687
   61.81,  0.1353,    0.1344,     0.0008806,      0.6509
   62.51,  0.1255,    0.1245,      0.001034,      0.8235
   62.51,  0.1254,    0.1245,     0.0009335,      0.7444
   63.19,  0.1163,    0.1153,      0.001023,      0.8795
   63.84,  0.1078,    0.1068,      0.001005,      0.9324
   63.84,  0.1077,    0.1068,     0.0009051,      0.8404
   64.47,     0.1,   0.09897,      0.001033,       1.033
   65.08, 0.09233,   0.09174,     0.0005877,      0.6365
   65.08,  0.0927,   0.09174,     0.0009577,       1.033
   65.67,   0.086,   0.08508,     0.0009242,       1.075
   66.23,  0.0797,   0.07892,     0.0007762,       0.974
   66.23, 0.07929,   0.07892,     0.0003662,      0.4619
   67.32,  0.0685,   0.06801,     0.0004948,      0.7224
   68.33,  0.0589,    0.0587,     0.0002006,      0.3405
   69.29,  0.0507,   0.05076,    -6.122e-05,     -0.1207
   70.18,  0.0437,   0.04398,    -0.0002819,     -0.6452
   71.03, 0.03799,   0.03818,    -0.0001948,     -0.5127
   71.03,  0.0378,   0.03818,    -0.0003848,      -1.018
   71.83,  0.0328,   0.03322,    -0.0004203,      -1.281
   72.59,  0.0286,   0.02896,    -0.0003621,      -1.266
   74.63, 0.01937,   0.01944,    -7.061e-05,     -0.3645
   77.44, 0.01042,   0.01045,    -3.098e-05,     -0.2973
   79.69,  0.0059,  0.005935,    -3.462e-05,     -0.5867
   81.53, 0.00353,  0.003557,     -2.72e-05,     -0.7704
   83.06, 0.00223,  0.002247,    -1.746e-05,     -0.7831
   85.48, 0.00105,   0.00104,     9.686e-06,      0.9225
   87.29, 0.00058, 0.0005716,     8.395e-06,       1.447
    88.7,0.000361, 0.0003585,     2.511e-06,      0.6955
   89.82,0.000247, 0.0002471,    -8.082e-08,    -0.03272
   90.75,0.000179, 0.0001817,    -2.739e-06,       -1.53
   95.15, 3.2e-05, 3.217e-05,    -1.682e-07,     -0.5257
   96.71,1.38e-05, 1.359e-05,     2.123e-07,       1.539
   97.51,7.87e-06, 7.866e-06,     4.479e-09,     0.05691
      98, 5.2e-06, 5.258e-06,    -5.825e-08,       -1.12
   98.99, 1.5e-06, 1.497e-06,     3.426e-09,      0.2284
     100,1.56e-09, 1.559e-09,     1.248e-12,        0.08
Average error: 0.001005
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deg</span> <span class="o">=</span> <span class="mi">6</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot with insets</span>
<span class="c1">###################################################</span>

<span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">],</span>
                               <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]],</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                              <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get a Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;aH2O_data.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 

<span class="c1">########</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">85</span>
<span class="c1">########</span>

<span class="c1">#keep only rows where PercentWt_Calc &gt;= n</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>

<span class="c1"># set weights for polynomial fit</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                         <span class="c1"># create list of ones same length as x</span>
<span class="c1">#weights[-10:] = [10]*10                     # relace last 10 entries in list with 10</span>
<span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span>       <span class="c1"># replace last 10 entries in list</span>
<span class="c1">#weights[0:10] = [10]*10                     # relace first 10 entries in list with 10</span>
<span class="c1">#weights[0:10] = [10,9,8,7,6,5,4,3,2,1]       # replace first 10 entries in list</span>
<span class="c1">#print(weights)</span>
<span class="c1">#weights = None                               # erase weights to do unweighted fit</span>

<span class="c1"># fit polynomial with weights</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;=85&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Polynomial Fit Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
<span class="c1">#        xlim=[-5,105],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>



<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Plot results of polynomial fit - inset</span>
<span class="c1">###################################################</span>


<span class="c1"># Set up axes for main plot</span>
<span class="c1">#axd[&quot;left&quot;].set(ylabel=y_label, xlabel=x_label,</span>
<span class="c1">#        xlim=[69.5,101],</span>
<span class="c1">#        ylim=[-0.03,0.1]</span>
<span class="c1">#        )</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">95</span><span class="p">,</span><span class="mf">100.2</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.000003</span><span class="p">,</span><span class="mf">0.00001</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>




<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\;a_{_</span><span class="si">{H_2O}</span><span class="s2">}\ /\%$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
<span class="c1">#        yticks = [-0.015,0,0.015]       </span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidit</span>
<span class="c1">###################################################</span>
<span class="c1">### calculate difference</span>
<span class="c1">###################################################</span>
<span class="c1"># x_diff = validate_df[&quot;%H2SO4&quot;]</span>
<span class="c1"># y_diff = validate_df[&quot;25C&quot;] - np.polyval(p, validate_df[&quot;%H2SO4&quot;])</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">x_diff</span><span class="p">))</span><span class="o">/</span><span class="n">y</span><span class="o">*</span><span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_diff</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>

<span class="c1">#print(x_oca)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_C2.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.3144404858464668e-10, -7.660823213573518e-08, 1.8616082649198916e-05, -0.002414407034715221, 0.1762746136695284, -6.8695694477137055, 111.64785064569885]
&gt;=85

0    -0.002592
1     0.084150
2    -0.167452
3     0.202973
4    -0.099002
5     0.082906
6     0.022835
7    -0.314449
8     0.109564
9     0.439414
10   -1.169443
Name: aH2O, dtype: float64
</pre></div>
</div>
<img alt="_images/51d8bd66c7859f030089452c6c1dd1919d8af79fe68b9429fd0b5469d1630acc.png" src="_images/51d8bd66c7859f030089452c6c1dd1919d8af79fe68b9429fd0b5469d1630acc.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.04031419e-03, 5.71604865e-04, 3.58489290e-04, 2.47080822e-04,
       1.81738687e-04, 3.21682250e-05, 1.35876603e-05, 7.86552124e-06,
       5.25825381e-06, 1.49657386e-06, 1.55875202e-09])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deg</span> <span class="o">=</span> <span class="mi">12</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot with insets</span>
<span class="c1">###################################################</span>

<span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">],</span>
                               <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]],</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                              <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get a Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;aH2O_data.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 

<span class="c1">########</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">63</span>
<span class="c1">########</span>

<span class="c1">#keep only rows where PercentWt_Calc &lt; n</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>

<span class="c1"># set weights for polynomial fit</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                         <span class="c1"># create list of ones same length as x</span>
<span class="c1">#weights[-10:] = [10]*10                     # relace last 10 entries in list with 10</span>
<span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span>       <span class="c1"># replace last 10 entries in list</span>
<span class="c1">#weights[0:10] = [10]*10                     # relace first 10 entries in list with 10</span>
<span class="c1">#weights[0:10] = [10,9,8,7,6,5,4,3,2,1]       # replace first 10 entries in list</span>
<span class="c1">#print(weights)</span>
<span class="n">weights</span> <span class="o">=</span> <span class="kc">None</span>                               <span class="c1"># erase weights to do unweighted fit</span>

<span class="c1"># fit polynomial with weights</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">p3</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;0 to &lt;60&quot;</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Polynomial Fit Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
<span class="c1">#        xlim=[-5,105],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>



<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Plot results of polynomial fit - inset</span>
<span class="c1">###################################################</span>


<span class="c1"># Set up axes for main plot</span>
<span class="c1">#axd[&quot;left&quot;].set(ylabel=y_label, xlabel=x_label,</span>
<span class="c1">#        xlim=[69.5,101],</span>
<span class="c1">#        ylim=[-0.03,0.1]</span>
<span class="c1">#        )</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">95</span><span class="p">,</span><span class="mf">100.2</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.000003</span><span class="p">,</span><span class="mf">0.00001</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>




<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\;a_{_</span><span class="si">{H_2O}</span><span class="s2">}\ /\%$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
<span class="c1">#        yticks = [-0.015,0,0.015]       </span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidit</span>
<span class="c1">###################################################</span>
<span class="c1">### calculate difference</span>
<span class="c1">###################################################</span>
<span class="c1"># x_diff = validate_df[&quot;%H2SO4&quot;]</span>
<span class="c1"># y_diff = validate_df[&quot;25C&quot;] - np.polyval(p, validate_df[&quot;%H2SO4&quot;])</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">x_diff</span><span class="p">))</span><span class="o">/</span><span class="n">y</span><span class="o">*</span><span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_diff</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>

<span class="c1">#print(x_oca)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_C2.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3.5028296585578643e-20, -1.3865886286472502e-17, 2.400749367443683e-15, -2.3864159015620214e-13, 1.5036351730947478e-11, -6.266897770870015e-10, 1.7536108298451186e-08, -3.2658573460234344e-07, 3.9261313528507605e-06, -3.2632125447469756e-05, 7.228976593850476e-05, -0.00375839371793719, 0.9999602819100265]
0 to &lt;60
0    -0.002149
1     0.002928
2     0.002551
3     0.000178
4    -0.001889
        ...   
63   -0.064280
64    0.141050
65   -0.028327
66    0.044822
67   -0.034887
Name: aH2O, Length: 68, dtype: float64
</pre></div>
</div>
<img alt="_images/e20de3a6d7b4ae9f032e79d0254a40e1e5d92221bbb255ce453941cd50bbe196.png" src="_images/e20de3a6d7b4ae9f032e79d0254a40e1e5d92221bbb255ce453941cd50bbe196.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deg</span> <span class="o">=</span> <span class="mi">8</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot with insets</span>
<span class="c1">###################################################</span>

<span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">],</span>
                               <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]],</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                              <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get a Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;aH2O_data.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 

<span class="c1">########</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">87</span>
<span class="c1">########</span>

<span class="c1">#keep only rows where PercentWt_Calc is between n and m</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">)]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>



<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>

<span class="c1"># set weights for polynomial fit</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                         <span class="c1"># create list of ones same length as x</span>
<span class="c1">#weights[-10:] = [10]*10                     # relace last 10 entries in list with 10</span>
<span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>       <span class="c1"># replace last 10 entries in list</span>
<span class="c1">#weights[0:10] = [10]*10                     # relace first 10 entries in list with 10</span>
<span class="c1">#weights[0:10] = [10,9,8,7,6,5,4,3,2,1]       # replace first 10 entries in list</span>
<span class="c1">#print(weights)</span>
<span class="c1">#weights = None                               # erase weights to do unweighted fit</span>

<span class="c1"># fit polynomial with weights</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;=60 to &lt;85&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Polynomial Fit Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
<span class="c1">#        xlim=[-5,105],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>



<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Plot results of polynomial fit - inset</span>
<span class="c1">###################################################</span>


<span class="c1"># Set up axes for main plot</span>
<span class="c1">#axd[&quot;left&quot;].set(ylabel=y_label, xlabel=x_label,</span>
<span class="c1">#        xlim=[69.5,101],</span>
<span class="c1">#        ylim=[-0.03,0.1]</span>
<span class="c1">#        )</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">95</span><span class="p">,</span><span class="mf">100.2</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.000003</span><span class="p">,</span><span class="mf">0.00001</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>




<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\;a_{_</span><span class="si">{H_2O}</span><span class="s2">}\ /\%$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
<span class="c1">#        yticks = [-0.015,0,0.015]       </span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidit</span>
<span class="c1">###################################################</span>
<span class="c1">### calculate difference</span>
<span class="c1">###################################################</span>
<span class="c1"># x_diff = validate_df[&quot;%H2SO4&quot;]</span>
<span class="c1"># y_diff = validate_df[&quot;25C&quot;] - np.polyval(p, validate_df[&quot;%H2SO4&quot;])</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">x_diff</span><span class="p">))</span><span class="o">/</span><span class="n">y</span><span class="o">*</span><span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_diff</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>

<span class="c1">#print(x_oca)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_C2.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;=60 to &lt;85
[5.273726317476769e-12, -3.2021412494451217e-09, 8.478783316886211e-07, -0.0001278611615731464, 0.01200962559880584, -0.7193893888613687, 26.83568358232527, -569.9778844885892, 5278.125388514924]
0    -0.104939
1     0.001384
2     0.206579
3     0.012244
4     0.028125
5    -0.051598
6    -0.038206
7    -0.055212
8    -0.148114
9     0.034253
10   -0.323500
11    0.076928
12    0.211062
13    0.242061
14   -0.273776
15    0.335542
16    0.345199
17    0.259807
18    0.051239
19    0.406602
20   -0.094000
21   -0.228942
22   -0.183783
23    0.382637
24   -0.241237
25   -0.129850
26    0.437006
27   -0.289044
28    0.050132
Name: aH2O, dtype: float64
</pre></div>
</div>
<img alt="_images/b5c513a74f06fff714cc564bcda8fb00742827154ca61d6c1c18b15df98cbaac.png" src="_images/b5c513a74f06fff714cc564bcda8fb00742827154ca61d6c1c18b15df98cbaac.png" />
</div>
</div>
</section>
<section id="build-model">
<h2>Build Model<a class="headerlink" href="#build-model" title="Link to this heading">#</a></h2>
<p>The code below establishes the model using the coefficinets in each region above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create piecewise polynomial fit for entire range 0-100</span>
<span class="c1"># Full precision coefficients from fitting in three segments</span>
<span class="c1"># The full precision coefficients are needed to avoid extreme errors in</span>
<span class="c1"># the high concentration regions where the predicted values are very small.</span>

<span class="k">def</span><span class="w"> </span><span class="nf">piecewise_85_100</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scalar piecewise polynomial evaluator.&quot;&quot;&quot;</span>

    <span class="c1"># polynomial coefficients for range 85-100</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.3144404858464668e-10</span><span class="p">,</span> 
         <span class="o">-</span><span class="mf">7.660823213573518e-08</span><span class="p">,</span> 
          <span class="mf">1.8616082649198916e-05</span><span class="p">,</span> 
         <span class="o">-</span><span class="mf">0.002414407034715221</span><span class="p">,</span> 
          <span class="mf">0.1762746136695284</span><span class="p">,</span> 
         <span class="o">-</span><span class="mf">6.8695694477137055</span><span class="p">,</span> 
        <span class="mf">111.64785064569885</span><span class="p">]</span>
              
<span class="c1">#    x = float(x)</span>
<span class="c1">#    return float(np.polyval(p1, x))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">piecewise_60_85</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scalar piecewise polynomial evaluator.&quot;&quot;&quot;</span>

    <span class="c1"># polynomial coefficients for range 60-85</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.3624463383155488e-11</span><span class="p">,</span> 
           <span class="mf">7.672094619025286e-09</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">1.884807056101815e-06</span><span class="p">,</span> 
           <span class="mf">0.0002638547059437287</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">0.023021682334033254</span><span class="p">,</span> 
           <span class="mf">1.282041898915145</span><span class="p">,</span> 
         <span class="o">-</span><span class="mf">44.50222158105233</span><span class="p">,</span> 
         <span class="mf">880.3763709481067</span><span class="p">,</span> 
       <span class="o">-</span><span class="mf">7598.898765490027</span><span class="p">]</span>
                                    
<span class="c1">#    x = float(x)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">piecewise_0_60</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scalar piecewise polynomial evaluator.&quot;&quot;&quot;</span>

    <span class="c1"># polynomial coefficients for range 0-60</span>
    <span class="n">p3</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">5.773338829443844e-20</span><span class="p">,</span> 
           <span class="mf">1.9241107621485452e-17</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">2.7809385013788315e-15</span><span class="p">,</span> 
           <span class="mf">2.2882355299128215e-13</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">1.183883807684228e-11</span><span class="p">,</span> 
           <span class="mf">4.0121074846344075e-10</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">8.975126614993668e-09</span><span class="p">,</span> 
           <span class="mf">1.3113349498962367e-07</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">1.2213930921579994e-06</span><span class="p">,</span> 
           <span class="mf">3.1589777766395234e-06</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">6.821487617101951e-05</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">0.003494581979577625</span><span class="p">,</span> 
           <span class="mf">0.9997966670703163</span><span class="p">]</span>

<span class="c1">#    x = float(x)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">piecewise_poly</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scalar piecewise polynomial evaluator.&quot;&quot;&quot;</span>


    <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">85</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">piecewise_85_100</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">piecewise_0_60</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">piecewise_60_85</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    

<span class="k">def</span><span class="w"> </span><span class="nf">v_piecewise_poly</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Vectorized piecewise polynomial evaluator. Accepts array-like x.&quot;&quot;&quot;</span>
    <span class="n">xa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">cond1</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">&gt;=</span> <span class="mi">85</span>
    <span class="n">cond2</span> <span class="o">=</span> <span class="p">(</span><span class="n">xa</span> <span class="o">&gt;=</span> <span class="mi">60</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xa</span> <span class="o">&lt;</span> <span class="mi">85</span><span class="p">)</span>
    <span class="n">cond3</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">&lt;</span> <span class="mi">60</span>
    <span class="k">if</span> <span class="n">cond1</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">y</span><span class="p">[</span><span class="n">cond1</span><span class="p">]</span> <span class="o">=</span> <span class="n">piecewise_85_100</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="n">cond1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">cond2</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">y</span><span class="p">[</span><span class="n">cond2</span><span class="p">]</span> <span class="o">=</span> <span class="n">piecewise_60_85</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="n">cond2</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">cond3</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">y</span><span class="p">[</span><span class="n">cond3</span><span class="p">]</span> <span class="o">=</span> <span class="n">piecewise_0_60</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="n">cond3</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">y</span>
    




<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;aH2O_data.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>


<span class="n">y1</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">v_piecewise_poly</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">y</span><span class="o">*</span><span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>






<span class="c1">#x1 = np.linspace(0,100,500)                  # x values for polynomial line</span>
<span class="c1">#y1 = v_piecewise_poly(x1)</span>
<span class="c1">#plt.plot(x1, y1,  </span>
<span class="c1">#          color = &quot;blue&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>
<span class="c1">#plt.scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 5, </span>
<span class="c1">#          color = &quot;black&quot;, edgecolors = &quot;black&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 2)</span>




<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span><span class="mf">2.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\rho\ / \,(\text{g/cm}^</span><span class="si">{3}</span><span class="s2">)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_C3.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  

<span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7ca94072bdb15724093adfa11198580747e5e53fe8008c299d704fe7bc49bc56.png" src="_images/7ca94072bdb15724093adfa11198580747e5e53fe8008c299d704fe7bc49bc56.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5776180362081504e-09
</pre></div>
</div>
</div>
</div>
</section>
<section id="piecewise-for-ah2o-whole-range">
<h2>Piecewise for aH2O whole range<a class="headerlink" href="#piecewise-for-ah2o-whole-range" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create piecewise polynomial fit for entire range 0-100</span>
<span class="c1"># Full precision coefficients from fitting in three segments</span>
<span class="c1"># The full precision coefficients are needed to avoid extreme errors in</span>
<span class="c1"># the high concentration regions where the predicted values are very small.</span>

<span class="k">def</span><span class="w"> </span><span class="nf">piecewise_85_100</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scalar piecewise polynomial evaluator.&quot;&quot;&quot;</span>

    <span class="c1"># polynomial coefficients for range 85-100</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.3144404858464668e-10</span><span class="p">,</span> 
         <span class="o">-</span><span class="mf">7.660823213573518e-08</span><span class="p">,</span> 
          <span class="mf">1.8616082649198916e-05</span><span class="p">,</span> 
         <span class="o">-</span><span class="mf">0.002414407034715221</span><span class="p">,</span> 
          <span class="mf">0.1762746136695284</span><span class="p">,</span> 
         <span class="o">-</span><span class="mf">6.8695694477137055</span><span class="p">,</span> 
        <span class="mf">111.64785064569885</span><span class="p">]</span>
              
<span class="c1">#    x = float(x)</span>
<span class="c1">#    return float(np.polyval(p1, x))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">piecewise_60_85</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scalar piecewise polynomial evaluator.&quot;&quot;&quot;</span>

    <span class="c1"># polynomial coefficients for range 60-85</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.273726317476769e-12</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">3.2021412494451217e-09</span><span class="p">,</span> 
          <span class="mf">8.478783316886211e-07</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">0.0001278611615731464</span><span class="p">,</span> 
          <span class="mf">0.01200962559880584</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">0.7193893888613687</span><span class="p">,</span> 
          <span class="mf">26.83568358232527</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">569.9778844885892</span><span class="p">,</span> 
          <span class="mf">5278.125388514924</span><span class="p">]</span>



<span class="c1">#    x = float(x)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">piecewise_0_60</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scalar piecewise polynomial evaluator.&quot;&quot;&quot;</span>

    <span class="c1"># polynomial coefficients for range 0-60</span>
    <span class="n">p3</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.5028296585578643e-20</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">1.3865886286472502e-17</span><span class="p">,</span> 
          <span class="mf">2.400749367443683e-15</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">2.3864159015620214e-13</span><span class="p">,</span> 
          <span class="mf">1.5036351730947478e-11</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">6.266897770870015e-10</span><span class="p">,</span> 
          <span class="mf">1.7536108298451186e-08</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">3.2658573460234344e-07</span><span class="p">,</span> 
          <span class="mf">3.9261313528507605e-06</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">3.2632125447469756e-05</span><span class="p">,</span> 
          <span class="mf">7.228976593850476e-05</span><span class="p">,</span> 
          <span class="o">-</span><span class="mf">0.00375839371793719</span><span class="p">,</span> 
          <span class="mf">0.9999602819100265</span><span class="p">]</span>


<span class="c1">#    x = float(x)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">piecewise_poly</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scalar piecewise polynomial evaluator.&quot;&quot;&quot;</span>


    <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">85</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">piecewise_85_100</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">piecewise_0_60</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">piecewise_60_85</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    

<span class="k">def</span><span class="w"> </span><span class="nf">v_piecewise_poly</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Vectorized piecewise polynomial evaluator. Accepts array-like x.&quot;&quot;&quot;</span>
    <span class="n">xa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">cond1</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">&gt;=</span> <span class="mf">85.0</span>
    <span class="n">cond2</span> <span class="o">=</span> <span class="p">(</span><span class="n">xa</span> <span class="o">&gt;=</span> <span class="mf">60.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xa</span> <span class="o">&lt;</span> <span class="mf">85.0</span><span class="p">)</span>
    <span class="n">cond3</span> <span class="o">=</span> <span class="n">xa</span> <span class="o">&lt;</span> <span class="mf">60.0</span>
    <span class="k">if</span> <span class="n">cond1</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">y</span><span class="p">[</span><span class="n">cond1</span><span class="p">]</span> <span class="o">=</span> <span class="n">piecewise_85_100</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="n">cond1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">cond2</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">y</span><span class="p">[</span><span class="n">cond2</span><span class="p">]</span> <span class="o">=</span> <span class="n">piecewise_60_85</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="n">cond2</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">cond3</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">y</span><span class="p">[</span><span class="n">cond3</span><span class="p">]</span> <span class="o">=</span> <span class="n">piecewise_0_60</span><span class="p">(</span><span class="n">xa</span><span class="p">[</span><span class="n">cond3</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="c1">###############################################################################</span>

<span class="n">deg</span> <span class="o">=</span> <span class="mi">8</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot with insets</span>
<span class="c1">###################################################</span>

<span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">],</span>
                               <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]],</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                              <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get a Giauque data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;aH2O_data.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>


<span class="n">y_diff_percent</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">v_piecewise_poly</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">y</span><span class="o">*</span><span class="mi">100</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">521</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">x1a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>                     <span class="c1"># clip x values to valid range 0-100</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">v_piecewise_poly</span><span class="p">(</span><span class="n">x1a</span><span class="p">)</span>

<span class="n">y_60</span> <span class="o">=</span> <span class="n">piecewise_0_60</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">y_60_85</span> <span class="o">=</span> <span class="n">piecewise_60_85</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">y_85</span> <span class="o">=</span> <span class="n">piecewise_85_100</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>



<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Polynomial Fit Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">110</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.1</span><span class="p">],</span>
        <span class="n">xticks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1a</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y_60</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y_60_85</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y_85</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>   <span class="c1"># vertical line at x=60</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">85</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>   <span class="c1"># vertical line at x=85</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Plot results of polynomial fit - inset</span>
<span class="c1">###################################################</span>


<span class="c1"># Set up axes for main plot</span>
<span class="c1">#axd[&quot;left&quot;].set(ylabel=y_label, xlabel=x_label,</span>
<span class="c1">#        xlim=[69.5,101],</span>
<span class="c1">#        ylim=[-0.03,0.1]</span>
<span class="c1">#        )</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">75</span><span class="p">,</span><span class="mf">100.2</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.0003</span><span class="p">,</span><span class="mf">0.005</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1a</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#axd[&quot;left&quot;].plot(x1, y_85,  </span>
<span class="c1">#          color = &quot;purple&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>




<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\;a_{_</span><span class="si">{H_2O}</span><span class="s2">}\ /\%$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">],</span>
<span class="c1">#        yticks = [-0.015,0,0.015]       </span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidit</span>
<span class="c1">###################################################</span>
<span class="c1">### calculate difference</span>
<span class="c1">###################################################</span>
<span class="c1"># x_diff = validate_df[&quot;%H2SO4&quot;]</span>
<span class="c1"># y_diff = validate_df[&quot;25C&quot;] - np.polyval(p, validate_df[&quot;%H2SO4&quot;])</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_diff_percent</span><span class="p">,</span>
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_diff_percent</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>

<span class="c1">#print(x_oca)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_D2.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_diff_percent</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/45c6fc78b64967b68757fd82c9f072d78c1b1873a613ff80d68d0ad39ce6aaef.png" src="_images/45c6fc78b64967b68757fd82c9f072d78c1b1873a613ff80d68d0ad39ce6aaef.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.05101027393220155
</pre></div>
</div>
</div>
</div>
</section>
<section id="log-plot">
<h2>Log plot<a class="headerlink" href="#log-plot" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deg</span> <span class="o">=</span> <span class="mi">12</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot with insets</span>
<span class="c1">###################################################</span>

<span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">],</span>
                               <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]],</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                              <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get a Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;aH2O_data.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 


<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">])</span>

<span class="c1"># set weights for polynomial fit</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                         <span class="c1"># create list of ones same length as x</span>
<span class="c1">#weights[-10:] = [10]*10                     # relace last 10 entries in list with 10</span>
<span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="mi">16</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">]</span>       <span class="c1"># replace last 10 entries in list</span>
<span class="c1">#weights[0:10] = [10]*10                     # relace first 10 entries in list with 10</span>
<span class="c1">#weights[0:10] = [10,9,8,7,6,5,4,3,2,1]       # replace first 10 entries in list</span>
<span class="c1">#print(weights)</span>
<span class="c1">#weights = 1/y                               # weight by 1/y to emphasize low values</span>
<span class="n">weights</span> <span class="o">=</span> <span class="kc">None</span>                               <span class="c1"># erase weights to do unweighted fit</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;weights&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># fit polynomial with weights</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">5000</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\log{a_{_</span><span class="si">{H_2O}</span><span class="s2">}}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Polynomial Fit Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
<span class="c1">#        ylim=[-0.05,1]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>



<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\log{a_{_</span><span class="si">{H_2O}</span><span class="s2">}}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Plot results of polynomial fit - inset</span>
<span class="c1">###################################################</span>


<span class="c1"># Set up axes for main plot</span>
<span class="c1">#axd[&quot;left&quot;].set(ylabel=y_label, xlabel=x_label,</span>
<span class="c1">#        xlim=[69.5,101],</span>
<span class="c1">#        ylim=[-0.03,0.1]</span>
<span class="c1">#        )</span>
<span class="c1">#axd[&quot;left&quot;].set(ylabel=y_label, xlabel=x_label,</span>
<span class="c1">#        xlim=[84.5,100.2],</span>
<span class="c1">#        ylim=[-0.00005,0.0005],</span>
<span class="c1">#        xticks = [85,90,95,100]</span>
<span class="c1">#        )</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">89</span><span class="p">,</span><span class="mf">100.2</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">10.1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>




<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\;\log{a_{_</span><span class="si">{H_2O}</span><span class="s2">}}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">1.05</span><span class="p">],</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>       
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidit</span>
<span class="c1">###################################################</span>
<span class="c1">### calculate difference</span>
<span class="c1">###################################################</span>
<span class="c1"># x_diff = validate_df[&quot;%H2SO4&quot;]</span>
<span class="c1"># y_diff = validate_df[&quot;25C&quot;] - np.polyval(p, validate_df[&quot;%H2SO4&quot;])</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x_diff</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_diff</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>

<span class="c1">#print(x_oca)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_D3.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>weights
None

0      0.053152
1     -0.033015
2     -0.049146
3     -0.033959
4     -0.009602
         ...   
96    -0.249847
97    -0.082403
98     0.102905
99     0.688164
100   -0.387811
Name: aH2O, Length: 101, dtype: float64
</pre></div>
</div>
<img alt="_images/40d6cd59f1c4355fccf37a97ecb4202b4b8cc3f9d7da39de438d757c9ea11721.png" src="_images/40d6cd59f1c4355fccf37a97ecb4202b4b8cc3f9d7da39de438d757c9ea11721.png" />
</div>
</div>
</section>
<section id="reexamination-of-interpolation-by-smooth-spline">
<h2>Reexamination of Interpolation by smooth spline<a class="headerlink" href="#reexamination-of-interpolation-by-smooth-spline" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">MakeInterpolationFunctionForH2OActivityinH2SO4byPercentWt</span><span class="p">():</span>


    <span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;01_Giauque_Table9_activityH2OinH2SO4.csv&quot;</span>

    <span class="n">molwtH2SO4</span> <span class="o">=</span> <span class="mf">98.08</span><span class="p">;</span> <span class="n">molwtH20</span> <span class="o">=</span> <span class="mf">18.0</span><span class="p">;</span> <span class="n">densityH2SO4</span> <span class="o">=</span> <span class="mf">1.83</span><span class="p">;</span> <span class="n">densityH2O</span> <span class="o">=</span> <span class="mf">1.000</span>
    
    <span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
    
    <span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                     <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                     <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                     <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 
    
    <span class="n">molal</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s2">&quot;conc H2SO4 / m&quot;</span><span class="p">]</span>
    <span class="n">mass_add_to_1_kg_water</span> <span class="o">=</span> <span class="n">molal</span> <span class="o">*</span> <span class="n">molwtH2SO4</span>
    <span class="n">total_mass_solution</span> <span class="o">=</span> <span class="n">mass_add_to_1_kg_water</span> <span class="o">+</span> <span class="mi">1000</span>
    <span class="n">percent_H2SO4</span> <span class="o">=</span> <span class="n">mass_add_to_1_kg_water</span> <span class="o">/</span> <span class="n">total_mass_solution</span> <span class="o">*</span> <span class="mi">100</span>
    
    <span class="n">df1</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">percent_H2SO4</span>
    <span class="n">df1</span><span class="p">[</span><span class="s2">&quot;mole fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">molal</span> <span class="o">/</span> <span class="p">(</span><span class="n">molal</span> <span class="o">+</span> <span class="mi">1000</span><span class="o">/</span><span class="n">molwtH20</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>
    
    <span class="n">interpolation</span> <span class="o">=</span> <span class="n">make_smoothing_spline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>      <span class="c1">### The x and y data</span>
                                          <span class="n">w</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>    <span class="c1">### A list of weights for each point (default = None)</span>
                                          <span class="n">lam</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1">### A factor for the degree of smoothing. Change this to change the smoothness.</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">interpolation</span><span class="p">)</span>

<span class="c1">##############################################################</span>
<span class="c1">### Import the data and perform calculations</span>
<span class="c1">##############################################################</span>

<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">aH2O_Data_File_Name</span>

<span class="n">dfHR</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
<span class="c1">#                 index_col=&quot;Substituent&quot;, </span>
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 
 
<span class="c1"># ###################################################</span>
<span class="c1">### Get the data</span>
<span class="c1">###################################################</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">dfHR</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dfHR</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>

<span class="c1">###################################################</span>
<span class="c1">### Use Interpolator for %H2SO4 to H0</span>
<span class="c1">###################################################</span>

<span class="n">interpoltor</span> <span class="o">=</span> <span class="n">MakeInterpolationFunctionForH2OActivityinH2SO4byPercentWt</span><span class="p">()</span>


<span class="n">x_smooth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y_smooth</span> <span class="o">=</span> <span class="n">interpoltor</span><span class="p">(</span><span class="n">x_smooth</span><span class="p">)</span>



<span class="c1">###################################################</span>
<span class="c1">### Set up labels for plots</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;%wt $</span><span class="si">{H_2SO_4}</span><span class="s2">$&quot;</span>
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_</span><span class="si">{H_2O}</span><span class="s2">$&quot;</span>

<span class="n">Title0</span> <span class="o">=</span> <span class="s2">&quot;$a_</span><span class="si">{H_2O}</span><span class="s2">$ vs. %wt $H_2SO_4$&quot;</span>

<span class="n">Title1</span> <span class="o">=</span> <span class="s2">&quot;Residuals&quot;</span>
<span class="n">y_label_residuals</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta a_</span><span class="si">{H_2O}</span><span class="s2"> \%$&quot;</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="c1">#style = &quot;S2_classic2.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">### Make the first plot (plot 0)</span>
<span class="c1">###################################################</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>  

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
          <span class="n">title</span> <span class="o">=</span> <span class="n">Title0</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>                
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">75</span><span class="p">,</span><span class="mf">100.2</span><span class="p">],</span>                  
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">3e-6</span><span class="p">,</span><span class="mf">1e-2</span><span class="p">]</span>
       <span class="p">)</span>
<span class="c1">#ax[0].set(</span>
<span class="c1">#          title = Title0,       </span>
<span class="c1">#          ylabel=y_label, </span>
<span class="c1">#          xlabel=x_label,                </span>
<span class="c1">#          xlim=[-0.2,100.2],                  </span>
<span class="c1">##          ylim=[-1e-6,1e-5]</span>
<span class="c1">#       )</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
             <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> 
             <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
             <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> 
             <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
             <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
             <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> 
             <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
             <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> 
             <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> 
             <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
             <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_smooth</span><span class="p">,</span> <span class="n">y_smooth</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">### Make the second plot (plot 1)</span>
<span class="c1">###################################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
          <span class="n">title</span> <span class="o">=</span> <span class="n">Title1</span><span class="p">,</span>       
          <span class="n">ylabel</span><span class="o">=</span><span class="n">y_label_residuals</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>                
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>                  
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">5.1</span><span class="p">,</span><span class="mf">5.1</span><span class="p">]</span>
       <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.07</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">span</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="n">interpoltor</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">percent_diff</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">/</span> <span class="n">y</span> <span class="o">*</span><span class="mi">100</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">percent_diff</span><span class="p">,</span> 
              <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> 
              <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
              <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> 
              <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
              <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">percent_diff</span><span class="p">,</span> 
              <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> 
              <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> 
              <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> 
              <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> 
              <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
              <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">percent_diff</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">percent_diff</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;aH2O_interp.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3118bd868c64de9df99ccdae914acbb30b89b8bb8d6b02daa46cf23d694348e2.png" src="_images/3118bd868c64de9df99ccdae914acbb30b89b8bb8d6b02daa46cf23d694348e2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.interpolate</span>


<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot with insets</span>
<span class="c1">###################################################</span>

<span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">],</span>
                               <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">],</span>
                               <span class="p">[</span><span class="s1">&#39;botleft&#39;</span><span class="p">,</span> <span class="s1">&#39;botright&#39;</span><span class="p">]],</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">8.7</span><span class="p">),</span>
                              <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get a Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;aH2O_data_no_duplicates.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 


<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>

<span class="n">interpolation</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">make_interp_spline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1">#interpolation = scipy.interpolate.Akima1DInterpolator(x, y, method = &quot;akima&quot;)        </span>
 
<span class="c1">#interpolation = scipy.interpolate.make_smoothing_spline(x, y,   # The x and y data</span>
<span class="c1">#                                w=None,       # A list of weights for each point (default = None)</span>
<span class="c1">#                                lam=0.        # A factor for the degree of smoothing. Change this to change the smoothness.</span>
<span class="c1">#                                )        </span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">5000</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1piece</span> <span class="o">=</span> <span class="n">v_piecewise_poly</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>


<span class="n">y1interp</span> <span class="o">=</span> <span class="n">interpolation</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">ydiff_piece</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1interp</span> <span class="o">-</span> <span class="n">y1piece</span><span class="p">)</span><span class="o">/</span><span class="n">y1piece</span><span class="o">*</span><span class="mi">100</span>

<span class="n">y1connectdots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ydiff_connectdots</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1connectdots</span> <span class="o">-</span> <span class="n">y1piece</span><span class="p">)</span><span class="o">/</span><span class="n">y1piece</span><span class="o">*</span><span class="mi">100</span> 

<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Polynomial Fit Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">102</span><span class="p">],</span>
<span class="c1">#        ylim=[-0.05,1]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1interp</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>



<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Plot results of polynomial fit - inset</span>
<span class="c1">###################################################</span>


<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">84.5</span><span class="p">,</span><span class="mf">100.5</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1e-5</span><span class="p">,</span><span class="mf">7e-4</span><span class="p">]</span>
        <span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1interp</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1piece</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1connectdots</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>   

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;botleft&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">98.5</span><span class="p">,</span><span class="mf">100.05</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1e-7</span><span class="p">,</span><span class="mf">2e-6</span><span class="p">]</span>
        <span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;botleft&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;botleft&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1interp</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;botleft&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1piece</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;botleft&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1connectdots</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>   



<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>




<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\;a_{_</span><span class="si">{H_2O}</span><span class="s2">}\ /\%$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">84.5</span><span class="p">,</span><span class="mf">100.5</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">120</span><span class="p">],</span>
<span class="c1">#        yticks = [-0.5,0,0.5,1]       </span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidit</span>
<span class="c1">###################################################</span>
<span class="c1">### calculate difference</span>
<span class="c1">###################################################</span>
<span class="c1"># x_diff = validate_df[&quot;%H2SO4&quot;]</span>
<span class="c1"># y_diff = validate_df[&quot;25C&quot;] - np.polyval(p, validate_df[&quot;%H2SO4&quot;])</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">interpolation</span><span class="p">(</span><span class="n">x_diff</span><span class="p">))</span><span class="o">/</span><span class="n">y</span><span class="o">*</span><span class="mi">100</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">v_piecewise_poly</span><span class="p">(</span><span class="n">x_diff</span><span class="p">))</span><span class="o">/</span><span class="n">y</span><span class="o">*</span><span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y_diff</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">#axd[&quot;right&quot;].plot(x_diff, y_diff,  </span>
<span class="c1">#          color = &quot;black&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">ydiff_piece</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Piecewise Poly&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">ydiff_connectdots</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Connect Dots&quot;</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;botright&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">98.5</span><span class="p">,</span><span class="mf">100.05</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">120</span><span class="p">]</span>
        <span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;botright&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">#axd[&quot;botright&quot;].plot(x_diff, y_diff,  </span>
<span class="c1">#          color = &quot;black&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;botright&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;botright&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">ydiff_piece</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Piecewise Poly&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;botright&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">ydiff_connectdots</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Connect Dots&quot;</span><span class="p">)</span>


<span class="c1">#print(x_oca)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_D4.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    -0.002149
1     0.002928
2     0.002551
3     0.000178
4    -0.001889
        ...   
75    0.022835
76   -0.314449
77    0.109564
78    0.439414
79   -1.169443
Name: aH2O, Length: 80, dtype: float64
</pre></div>
</div>
<img alt="_images/8a33b2f6469c336afba4c57a297bc806de782b4b1e788d7a41fc4042a9036281.png" src="_images/8a33b2f6469c336afba4c57a297bc806de782b4b1e788d7a41fc4042a9036281.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.interpolate</span>


<span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">xlim1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
        <span class="n">ylim1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.9</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ylim2</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">3e-2</span><span class="p">,</span><span class="mf">1e-2</span><span class="p">]</span>
<span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">xlim1</span><span class="o">=</span><span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">]</span>
        <span class="n">ylim1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.1</span><span class="p">,</span><span class="mf">0.6</span><span class="p">]</span>
        <span class="n">ylim2</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">2e-1</span><span class="p">,</span><span class="mf">2e-1</span><span class="p">]</span>
<span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">xlim1</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span><span class="mi">80</span><span class="p">]</span>
        <span class="n">ylim1</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.15</span><span class="p">]</span>
        <span class="n">ylim2</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1e-0</span><span class="p">,</span><span class="mf">4e-0</span><span class="p">]</span>
<span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">xlim1</span><span class="o">=</span><span class="p">[</span><span class="mf">80.0</span><span class="p">,</span><span class="mf">100.5</span><span class="p">]</span>
        <span class="n">ylim1</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1e-6</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">]</span>
        <span class="n">ylim2</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">120</span><span class="p">]</span>

<span class="c1">###################################################</span>
<span class="c1">### Create figure for plot with insets</span>
<span class="c1">###################################################</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>  

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get a Perry data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;aH2O_data_no_duplicates.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Fit a Polynomial Model to the training data</span>
<span class="c1">###################################################</span>

<span class="c1">### Convert Molal to PercentWt</span>
<span class="c1">### PercentWt = (molality * molwtH2SO4) / (molality * molwtH2SO4 + 1000) * 100</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">molwtH2SO4</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> 


<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PercentWt_Calc&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;aH2O&quot;</span><span class="p">]</span>

<span class="n">interpolation</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">make_interp_spline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1">#interpolation = scipy.interpolate.Akima1DInterpolator(x, y, method = &quot;akima&quot;)        </span>
 
<span class="c1">#interpolation = scipy.interpolate.make_smoothing_spline(x, y,   # The x and y data</span>
<span class="c1">#                                w=None,       # A list of weights for each point (default = None)</span>
<span class="c1">#                                lam=0.        # A factor for the degree of smoothing. Change this to change the smoothness.</span>
<span class="c1">#                                )        </span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">100.</span><span class="p">,</span><span class="mi">5000</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1piece</span> <span class="o">=</span> <span class="n">v_piecewise_poly</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>


<span class="n">y1interp</span> <span class="o">=</span> <span class="n">interpolation</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">ydiff_piece</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1interp</span> <span class="o">-</span> <span class="n">y1piece</span><span class="p">)</span><span class="o">/</span><span class="n">y1</span><span class="o">*</span><span class="mi">100</span>

<span class="n">y1connectdots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ydiff_connectdots</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1connectdots</span> <span class="o">-</span> <span class="n">y1piece</span><span class="p">)</span><span class="o">/</span><span class="n">y1</span><span class="o">*</span><span class="mi">100</span> 

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$a_{_</span><span class="si">{H_2O}</span><span class="s2">}$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### Polynomial Fit Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="n">xlim1</span><span class="p">,</span>
        <span class="n">ylim</span><span class="o">=</span><span class="n">ylim1</span>
        <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1interp</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1piece</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1connectdots</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>   


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta\;a_{_</span><span class="si">{H_2O}</span><span class="s2">}\ /\%$&quot;</span> 

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="n">xlim1</span><span class="p">,</span>
        <span class="n">ylim</span><span class="o">=</span><span class="n">ylim2</span><span class="p">,</span>
<span class="c1">#        yticks = [-0.5,0,0.5,1]       </span>
        <span class="p">)</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="c1">#y_diff = (y - interpolation(x_diff))/y*100</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">v_piecewise_poly</span><span class="p">(</span><span class="n">x_diff</span><span class="p">))</span><span class="o">/</span><span class="n">y</span><span class="o">*</span><span class="mi">100</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">#ax[1].plot(x_diff, y_diff,  </span>
<span class="c1">#          color = &quot;black&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">ydiff_piece</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Piecewise Poly&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">ydiff_connectdots</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Connect Dots&quot;</span><span class="p">)</span>


<span class="c1">#print(x_oca)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_E1.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Points is diff between my piecewise fit and given data&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Blue is diff between my piecewise fit and spline&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Green is diff between my piecewise fit and connect-the-dots&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b782fb04ba309e756abac11d8ec333bd10a36b85ca5c76c577a0036340cf0564.png" src="_images/b782fb04ba309e756abac11d8ec333bd10a36b85ca5c76c577a0036340cf0564.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Points is diff between my piecewise fit and given data
Blue is diff between my piecewise fit and spline
Green is diff between my piecewise fit and connect-the-dots
</pre></div>
</div>
</div>
</div>
</section>
<section id="models-for-h-0">
<h2>Models for <span class="math notranslate nohighlight">\(H_0\)</span><a class="headerlink" href="#models-for-h-0" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  
<span class="c1">#ax2 = ax.twinx()</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$H_0$&quot;</span> 


<span class="c1"># Set up axes for main plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
<span class="c1">#        xlim=[-5,105],</span>
<span class="c1">#        ylim=[0.95,2.05]</span>
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidity</span>

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Gillespie data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Gillespie_1971.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">mec</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">mfc</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">mew</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#ax.scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 5, </span>
<span class="c1">#          color = &quot;black&quot;, edgecolors = &quot;black&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 3)</span>


<span class="c1">###################################################</span>
<span class="c1">### Get and plot Johnston data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Johnston_1969.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#ax.scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 40, </span>
<span class="c1">#          color = &quot;white&quot;, edgecolors = &quot;green&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 2)</span>
<span class="c1">###################################################</span>
<span class="c1">### Get and plot Jorgenson data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Jorgenson_1963.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="c1">#ax.scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 80, </span>
<span class="c1">#          color = &quot;white&quot;, edgecolors = &quot;red&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 1)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Paul data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Paul_1957B.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="c1">#ax.scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 80, </span>
<span class="c1">#          color = &quot;white&quot;, edgecolors = &quot;red&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 1)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Tickle data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Tickle_1970.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="c1">#ax.scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 80, </span>
<span class="c1">#          color = &quot;white&quot;, edgecolors = &quot;red&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 1)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_F1.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5a84237c3615f5f1460f9ababe9fa6582b1d681330cb18dfac0c851ab88e4f61.png" src="_images/5a84237c3615f5f1460f9ababe9fa6582b1d681330cb18dfac0c851ab88e4f61.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################</span>
<span class="c1">### Create figure for plot</span>
<span class="c1">###################################################</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="c1">#ax2 = ax.twinx()</span>

<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$H_0$&quot;</span> 

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>  

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title0,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>                
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">102</span><span class="p">],</span>                  
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">]</span>
       <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title0,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>                
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">89.5</span><span class="p">,</span><span class="mi">102</span><span class="p">],</span>                  
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">7.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.1</span><span class="p">]</span>
       <span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Gillespie data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Gillespie_1971.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
<span class="c1">#          marker = &quot;o&quot;, ms = 5, mec = &quot;blue&quot;, mfc = &quot;white&quot;, mew = 0.5,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="mf">4.5</span><span class="p">,</span> <span class="n">mec</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">mfc</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">mew</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">#ax.scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 5, </span>
<span class="c1">#          color = &quot;black&quot;, edgecolors = &quot;black&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 3)</span>


<span class="c1">###################################################</span>
<span class="c1">### Get and plot Johnston data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Johnston_1969.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="mf">6.6</span><span class="p">,</span> <span class="n">mec</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">mfc</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">mew</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1">#ax.scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 40, </span>
<span class="c1">#          color = &quot;white&quot;, edgecolors = &quot;green&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 2)</span>
<span class="c1">###################################################</span>
<span class="c1">### Get and plot Jorgenson data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Jorgenson_1963.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="c1">#ax.scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 80, </span>
<span class="c1">#          color = &quot;white&quot;, edgecolors = &quot;red&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 1)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">mec</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">mfc</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">mew</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Paul data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Paul_1957B.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="c1">#ax.scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 80, </span>
<span class="c1">#          color = &quot;white&quot;, edgecolors = &quot;red&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 1)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">mec</span> <span class="o">=</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">mfc</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">mew</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Tickle data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Tickle_1970.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="c1">#ax.scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 80, </span>
<span class="c1">#          color = &quot;white&quot;, edgecolors = &quot;red&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 1)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>  
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">mec</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">mfc</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">mew</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_F1.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c7f3c84894d1109f83051f8d68564e960366a1de6bec7d85d3037d0653e90088.png" src="_images/c7f3c84894d1109f83051f8d68564e960366a1de6bec7d85d3037d0653e90088.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################</span>
<span class="c1">### Get  Gillespie data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Gillespie_1971.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df_gill</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Get Johnston data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Johnston_1969.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df_johnson</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Jorgenson data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Jorgenson_1963.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df_jorg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_gill</span><span class="p">,</span> <span class="n">df_johnson</span><span class="p">,</span> <span class="n">df_jorg</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="c1"># set weights for polynomial fit</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                         <span class="c1"># create list of ones same length as x</span>
<span class="c1">#weights[-10:] = [10]*10                     # relace last 10 entries in list with 10</span>
<span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>       <span class="c1"># replace last 10 entries in list</span>
<span class="c1">#weights[0:10] = [10]*10                     # relace first 10 entries in list with 10</span>
<span class="c1">#weights[0:10] = [10,9,8,7,6,5,4,3,2,1]       # replace first 10 entries in list</span>
<span class="c1">#print(weights)</span>
<span class="n">weights</span> <span class="o">=</span> <span class="kc">None</span>                               <span class="c1"># erase weights to do unweighted fit</span>

<span class="c1"># fit polynomial with weights</span>
<span class="n">deg</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>  

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$H_0$&quot;</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title0,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>                
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">102</span><span class="p">],</span>                  
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">13</span><span class="p">]</span>
       <span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_G1.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>parameters
[-3.0521974554643054e-24, 2.0120200782718483e-21, -5.857235271355093e-19, 9.865263766292318e-17, -1.0541399797253059e-14, 7.303850417261557e-13, -3.1248533602826995e-11, 6.186349220432335e-10, 1.1400438649617385e-08, -1.15068039274931e-06, 3.518797319264536e-05, -0.0005621226765906635, 0.004435462706014196, -0.007020881583651662, -0.18900681622663348, 0.9060912074521184]
</pre></div>
</div>
<img alt="_images/3c996cbb96a27617d676cde62f14189d809b1265c994167dc17cba5caca7438b.png" src="_images/3c996cbb96a27617d676cde62f14189d809b1265c994167dc17cba5caca7438b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################</span>
<span class="c1">### Get  Gillespie data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Gillespie_1971.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df_gill</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Get Johnston data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Johnston_1969.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df_johnson</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Jorgenson data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Jorgenson_1963.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df_jorg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_gill</span><span class="p">,</span> <span class="n">df_johnson</span><span class="p">,</span> <span class="n">df_jorg</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>

<span class="c1"># set weights for polynomial fit</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                         <span class="c1"># create list of ones same length as x</span>
<span class="c1">#weights[-10:] = [10]*10                     # relace last 10 entries in list with 10</span>
<span class="n">weights</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>       <span class="c1"># replace last 10 entries in list</span>
<span class="c1">#weights[0:10] = [10]*10                     # relace first 10 entries in list with 10</span>
<span class="c1">#weights[0:10] = [10,9,8,7,6,5,4,3,2,1]       # replace first 10 entries in list</span>
<span class="c1">#print(weights)</span>
<span class="n">weights</span> <span class="o">=</span> <span class="kc">None</span>                               <span class="c1"># erase weights to do unweighted fit</span>

<span class="c1"># fit polynomial with weights</span>
<span class="n">deg</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>

<span class="n">gs_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axd</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">],</span>
                               <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]],</span>
                              <span class="n">gridspec_kw</span><span class="o">=</span><span class="n">gs_kw</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
                              <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$H_0$&quot;</span> 

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
<span class="c1">#          title = Title0,       </span>
          <span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>                
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">102</span><span class="p">],</span>                  
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">13</span><span class="p">]</span>
       <span class="p">)</span>



<span class="c1">###################################################</span>
<span class="c1">### Polynomial Fit Plot</span>
<span class="c1">###################################################</span>


<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>


<span class="c1">#axd[&quot;top&quot;].scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 5, </span>
<span class="c1">#          color = &quot;black&quot;, edgecolors = &quot;black&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 5)</span>
<span class="c1">#</span>
<span class="c1">#axd[&quot;top&quot;].plot(x, y,  </span>
<span class="c1">#          color = &quot;red&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>


<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$H_0$&quot;</span> 

<span class="c1">###################################################</span>
<span class="c1">### Plot results of polynomial fit - inset</span>
<span class="c1">###################################################</span>


<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">79</span><span class="p">,</span><span class="mf">101.2</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">13</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.2</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>

<span class="c1">#axd[&quot;left&quot;].scatter(x, y, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 5, </span>
<span class="c1">#          color = &quot;black&quot;, edgecolors = &quot;black&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 5)</span>
<span class="c1">#axd[&quot;left&quot;].plot(x1, y1,  </span>
<span class="c1">#          color = &quot;red&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>


<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>
<span class="c1">###################################################</span>




<span class="c1">###################################################</span>
<span class="c1">### Set up labels</span>
<span class="c1">###################################################</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\Delta H_0$&quot;</span> 


<span class="c1">###################################################</span>
<span class="c1">### RATE vs ACIDITY Plot</span>
<span class="c1">###################################################</span>

<span class="c1"># Set up axes for main plot</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.55</span><span class="p">],</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>       
        <span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">79</span><span class="p">,</span><span class="mi">102</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.55</span><span class="p">],</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>       
        <span class="p">)</span>
<span class="c1"># Data points for kobs vs Acidit</span>
<span class="c1">###################################################</span>
<span class="c1">### calculate difference</span>
<span class="c1">###################################################</span>
<span class="c1"># x_diff = validate_df[&quot;%H2SO4&quot;]</span>
<span class="c1"># y_diff = validate_df[&quot;25C&quot;] - np.polyval(p, validate_df[&quot;%H2SO4&quot;])</span>

<span class="n">x_diff</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">y_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">x_diff</span><span class="p">))</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_diff</span><span class="p">,</span> <span class="n">y_diff</span><span class="p">,</span>
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>


<span class="c1">#axd[&quot;right&quot;].scatter(x_diff, y_diff, </span>
<span class="c1">#          marker = &quot;o&quot;, s = 5, </span>
<span class="c1">#          color = &quot;black&quot;, edgecolors = &quot;black&quot;, linewidths=0.7, </span>
<span class="c1">#          zorder = 5)</span>
<span class="c1">#</span>
<span class="c1">#axd[&quot;right&quot;].plot(x_diff, y_diff,  </span>
<span class="c1">#          color = &quot;black&quot;, linewidth=0.7, </span>
<span class="c1">#          zorder = 1)</span>
<span class="n">axd</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># horizontal line at y=0</span>

<span class="c1">#print(x_oca)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_G2.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>parameters
[-3.0521974554643054e-24, 2.0120200782718483e-21, -5.857235271355093e-19, 9.865263766292318e-17, -1.0541399797253059e-14, 7.303850417261557e-13, -3.1248533602826995e-11, 6.186349220432335e-10, 1.1400438649617385e-08, -1.15068039274931e-06, 3.518797319264536e-05, -0.0005621226765906635, 0.004435462706014196, -0.007020881583651662, -0.18900681622663348, 0.9060912074521184]
</pre></div>
</div>
<img alt="_images/3957496a280bcffc457e2f992f5df7d80ee84fbbb4dfebfc43dfcab1540af191.png" src="_images/3957496a280bcffc457e2f992f5df7d80ee84fbbb4dfebfc43dfcab1540af191.png" />
</div>
</div>
</section>
<section id="a-spline-interpolation-using-johnson-and-gillespie">
<h2>A Spline Interpolation USING JOHNSON AND GILLESPIE<a class="headerlink" href="#a-spline-interpolation-using-johnson-and-gillespie" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################################</span>
<span class="c1">### Get  Gillespie data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Gillespie_1971.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df_gill</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Get Johnston data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Johnston_1969.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df_johnson</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 

<span class="c1">###################################################</span>
<span class="c1">### Get and plot Jorgenson data</span>
<span class="c1">###################################################</span>

<span class="n">Data_File_Name</span> <span class="o">=</span> <span class="s2">&quot;02_H0_H2SO4_Jorgenson_1963.csv&quot;</span>
<span class="n">Filename</span> <span class="o">=</span> <span class="n">github_location</span> <span class="o">+</span> <span class="n">Data_File_Name</span>
<span class="n">df_jorg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Filename</span><span class="p">,</span> 
                 <span class="n">delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> 
                 <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                 <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">)</span> 


<span class="n">df_johnson</span> <span class="o">=</span> <span class="n">df_johnson</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_johnson</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">94.9</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_gill</span><span class="p">,</span> <span class="n">df_johnson</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#df = df.reset_index().groupby(&quot;%H2SO4&quot;).mean()</span>


<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;%H2SO4&quot;</span><span class="p">]</span>
<span class="c1">#x = df.index</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;H0&quot;</span><span class="p">]</span>


<span class="n">interpolation</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">make_interp_spline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1">#interpolation = scipy.interpolate.Akima1DInterpolator(x, y, method = &quot;akima&quot;)        </span>
 
<span class="c1">#interpolation = scipy.interpolate.make_smoothing_spline(x, y,   # The x and y data</span>
<span class="c1">#                                w=None,       # A list of weights for each point (default = None)</span>
<span class="c1">#                                lam=0.005        # A factor for the degree of smoothing. Change this to change the smoothness.</span>
<span class="c1">#                                )        </span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>                  <span class="c1"># x values for polynomial line</span>
<span class="n">y1interp</span> <span class="o">=</span> <span class="n">interpolation</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>

<span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;tufte.mplstyle&quot;</span>
<span class="n">style_name</span> <span class="o">=</span> <span class="n">github_location_styles</span> <span class="o">+</span> <span class="n">style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style_name</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>  
<span class="c1">#ax2 = ax.twinx()</span>

<span class="n">x_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$w\ /\,\%H_2SO_4$&quot;</span> 
<span class="n">y_label</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$H_0$&quot;</span> 

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span> <span class="o">=</span> <span class="n">y_label</span><span class="p">,</span> 
          <span class="n">xlabel</span> <span class="o">=</span> <span class="n">x_label</span><span class="p">,</span>
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">105</span><span class="p">],</span>
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">14</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1interp</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1interp</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="c1">#ax[0].vlines(100, -8.2, -13, linewidth=0.7, color=&quot;black&quot;, zorder = 0)</span>

<span class="c1">##################################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="n">y_label</span><span class="p">,</span> 
          <span class="n">xlabel</span><span class="o">=</span><span class="n">x_label</span><span class="p">,</span>
          <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">89</span><span class="p">,</span><span class="mf">101.2</span><span class="p">],</span>
          <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">8.5</span><span class="p">,</span><span class="o">-</span><span class="mi">13</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
          <span class="n">marker</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span> 
          <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
          <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
          <span class="n">zorder</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1interp</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1interp</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.2</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">##################################</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;plots/plot_G3.pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data/H0-model_temp.csv&quot;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e8173694044206d5b382fef69771c966337b8d84130859b8a008ada7207f74c6.png" src="_images/e8173694044206d5b382fef69771c966337b8d84130859b8a008ada7207f74c6.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-molal-to-mass">Converting Molal to %mass</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#at-25degc">At 25degC</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#refs">Refs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameterized-model-for-density">Parameterized Model for Density</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-the-polynomial-model-and-fit">make the Polynomial Model and Fit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spline-interpolation-for-density-of-h2so4-using-perry-data">Spline interpolation for density of H2SO4 using Perry Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-a-h-2o">Plotting <span class="math notranslate nohighlight">\(a_{H_2O}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-data-sets">Other Data Sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-data-sets">Merge Data Sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attempt-polynomial-fit">Attempt Polynomial Fit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-model">Build Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#piecewise-for-ah2o-whole-range">Piecewise for aH2O whole range</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#log-plot">Log plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reexamination-of-interpolation-by-smooth-spline">Reexamination of Interpolation by smooth spline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#models-for-h-0">Models for <span class="math notranslate nohighlight">\(H_0\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-spline-interpolation-using-johnson-and-gillespie">A Spline Interpolation USING JOHNSON AND GILLESPIE</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Barry Linkletter
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>